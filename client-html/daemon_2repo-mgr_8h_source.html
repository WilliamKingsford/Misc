<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>My Project: seafile-4.1.2/daemon/repo-mgr.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">My Project
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">seafile-4.1.2/daemon/repo-mgr.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="daemon_2repo-mgr_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* -*- Mode: C; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- */</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="preprocessor">#ifndef SEAF_REPO_MGR_H</span>
<a name="l00004"></a>00004 <span class="preprocessor"></span><span class="preprocessor">#define SEAF_REPO_MGR_H</span>
<a name="l00005"></a>00005 <span class="preprocessor"></span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &quot;common.h&quot;</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;pthread.h&gt;</span>
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="preprocessor">#include &quot;seafile-object.h&quot;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &quot;<a class="code" href="commit-mgr_8h.html">commit-mgr.h</a>&quot;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;<a class="code" href="branch-mgr_8h.html">branch-mgr.h</a>&quot;</span>
<a name="l00013"></a>00013 
<a name="l00014"></a><a class="code" href="daemon_2repo-mgr_8h.html#a2d6340e4ada61e93d58c0411fa6fcfe5">00014</a> <span class="preprocessor">#define REPO_AUTO_SYNC        &quot;auto-sync&quot;</span>
<a name="l00015"></a><a class="code" href="daemon_2repo-mgr_8h.html#a502b8f6b8ad6882683294f590b302cc0">00015</a> <span class="preprocessor"></span><span class="preprocessor">#define REPO_AUTO_FETCH       &quot;auto-fetch&quot;</span>
<a name="l00016"></a><a class="code" href="daemon_2repo-mgr_8h.html#ade9494be6db68ada29c0b9812da1f762">00016</a> <span class="preprocessor"></span><span class="preprocessor">#define REPO_AUTO_UPLOAD      &quot;auto-upload&quot;</span>
<a name="l00017"></a><a class="code" href="daemon_2repo-mgr_8h.html#ae570b1e2acc8cfd7c3433f974674cfa9">00017</a> <span class="preprocessor"></span><span class="preprocessor">#define REPO_AUTO_MERGE       &quot;auto-merge&quot;</span>
<a name="l00018"></a><a class="code" href="daemon_2repo-mgr_8h.html#ac5d086060283109eedf8bb27d3e7965c">00018</a> <span class="preprocessor"></span><span class="preprocessor">#define REPO_AUTO_COMMIT      &quot;auto-commit&quot;</span>
<a name="l00019"></a><a class="code" href="daemon_2repo-mgr_8h.html#a88e179c17ec642b434e82bb40403a6ba">00019</a> <span class="preprocessor"></span><span class="preprocessor">#define REPO_RELAY_ID         &quot;relay-id&quot;</span>
<a name="l00020"></a><a class="code" href="daemon_2repo-mgr_8h.html#a4dc57106ac24f4cf008c10b85ae1e384">00020</a> <span class="preprocessor"></span><span class="preprocessor">#define REPO_NET_BROWSABLE    &quot;net-browsable&quot;</span>
<a name="l00021"></a><a class="code" href="daemon_2repo-mgr_8h.html#ae717be3f43ee1abacd91e3703906d518">00021</a> <span class="preprocessor"></span><span class="preprocessor">#define REPO_DOUBLE_SYNC      &quot;double-sync&quot;</span>
<a name="l00022"></a><a class="code" href="daemon_2repo-mgr_8h.html#af63040384723b88eb87e261c8ebb298b">00022</a> <span class="preprocessor"></span><span class="preprocessor">#define REPO_REMOTE_HEAD      &quot;remote-head&quot;</span>
<a name="l00023"></a><a class="code" href="daemon_2repo-mgr_8h.html#ab09a088f0dfff9872d5dfb605ed1cade">00023</a> <span class="preprocessor"></span><span class="preprocessor">#define REPO_LOCAL_HEAD       &quot;local-head&quot;</span>
<a name="l00024"></a><a class="code" href="daemon_2repo-mgr_8h.html#a710e166548b51934b6a3d916eb86442e">00024</a> <span class="preprocessor"></span><span class="preprocessor">#define REPO_PROP_EMAIL       &quot;email&quot;</span>
<a name="l00025"></a><a class="code" href="daemon_2repo-mgr_8h.html#a1d2a9886ff3a1d69407ba0b287cbeac4">00025</a> <span class="preprocessor"></span><span class="preprocessor">#define REPO_PROP_TOKEN       &quot;token&quot;</span>
<a name="l00026"></a><a class="code" href="daemon_2repo-mgr_8h.html#aed012d90d39cca6687bcc13ab66cb796">00026</a> <span class="preprocessor"></span><span class="preprocessor">#define REPO_PROP_RELAY_ADDR  &quot;relay-address&quot;</span>
<a name="l00027"></a><a class="code" href="daemon_2repo-mgr_8h.html#a566c5e4d2fcf5f9de3a8e996430a22f4">00027</a> <span class="preprocessor"></span><span class="preprocessor">#define REPO_PROP_RELAY_PORT  &quot;relay-port&quot;</span>
<a name="l00028"></a><a class="code" href="daemon_2repo-mgr_8h.html#a913fa2a61a58336164c1d2538e12f60e">00028</a> <span class="preprocessor"></span><span class="preprocessor">#define REPO_ENCRYPTED 0x1</span>
<a name="l00029"></a><a class="code" href="daemon_2repo-mgr_8h.html#a1d90660156a493f14023ca76013acd64">00029</a> <span class="preprocessor"></span><span class="preprocessor">#define REPO_PROP_DOWNLOAD_HEAD &quot;download-head&quot;</span>
<a name="l00030"></a><a class="code" href="daemon_2repo-mgr_8h.html#a152076b2a531e04976bdc390e8d43b92">00030</a> <span class="preprocessor"></span><span class="preprocessor">#define REPO_PROP_IS_READONLY &quot;is-readonly&quot;</span>
<a name="l00031"></a><a class="code" href="daemon_2repo-mgr_8h.html#a55797c21d6209596736b5a81a8411ff9">00031</a> <span class="preprocessor"></span><span class="preprocessor">#define REPO_PROP_SERVER_URL  &quot;server-url&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor"></span>
<a name="l00033"></a>00033 <span class="keyword">struct </span><a class="code" href="struct__SeafRepoManager.html">_SeafRepoManager</a>;
<a name="l00034"></a><a class="code" href="daemon_2repo-mgr_8h.html#a3e8b6c8c2a077518a17c75c6ace3ae1c">00034</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__SeafRepo.html">_SeafRepo</a> <a class="code" href="struct__SeafRepo.html">SeafRepo</a>;
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="comment">/* The caller can use the properties directly. But the caller should</span>
<a name="l00037"></a>00037 <span class="comment"> * always write on repos via the API. </span>
<a name="l00038"></a>00038 <span class="comment"> */</span>
<a name="l00039"></a><a class="code" href="struct__SeafRepo.html">00039</a> <span class="keyword">struct </span><a class="code" href="struct__SeafRepo.html">_SeafRepo</a> {
<a name="l00040"></a><a class="code" href="struct__SeafRepo.html#a9bae0acc12e2e63b0686027f7399e034">00040</a>     <span class="keyword">struct </span><a class="code" href="struct__SeafRepoManager.html">_SeafRepoManager</a> *<a class="code" href="struct__SeafRepo.html#a9bae0acc12e2e63b0686027f7399e034">manager</a>;
<a name="l00041"></a>00041 
<a name="l00042"></a><a class="code" href="struct__SeafRepo.html#a9d6bc9ae525da00bc4c7d1f62dc9b762">00042</a>     gchar       <span class="keywordtype">id</span>[37];
<a name="l00043"></a><a class="code" href="struct__SeafRepo.html#a235da8ad7bdcaa5bf5b8e2b3e6e23b88">00043</a>     gchar      *<a class="code" href="struct__SeafRepo.html#a235da8ad7bdcaa5bf5b8e2b3e6e23b88">name</a>;
<a name="l00044"></a><a class="code" href="struct__SeafRepo.html#a2bcd0258d3e8deb15a45aa8403c9156d">00044</a>     gchar      *<a class="code" href="struct__SeafRepo.html#a2bcd0258d3e8deb15a45aa8403c9156d">desc</a>;
<a name="l00045"></a><a class="code" href="struct__SeafRepo.html#a4d7c42c5644eb9dbfd24bf43adb9316c">00045</a>     gchar      *<a class="code" href="struct__SeafRepo.html#a4d7c42c5644eb9dbfd24bf43adb9316c">category</a>;       <span class="comment">/* not used yet */</span>
<a name="l00046"></a><a class="code" href="struct__SeafRepo.html#ab50d0e015838fe83d735ba2d6cb40804">00046</a>     gboolean    <a class="code" href="struct__SeafRepo.html#ab50d0e015838fe83d735ba2d6cb40804">encrypted</a>;
<a name="l00047"></a><a class="code" href="struct__SeafRepo.html#af4cb7f672489dceb52cbd47da097ebf8">00047</a>     <span class="keywordtype">int</span>         <a class="code" href="struct__SeafRepo.html#af4cb7f672489dceb52cbd47da097ebf8">enc_version</a>;
<a name="l00048"></a><a class="code" href="struct__SeafRepo.html#ab067d494e7ac35fb57f0a3c448e816d2">00048</a>     gchar       <a class="code" href="struct__SeafRepo.html#ab067d494e7ac35fb57f0a3c448e816d2">magic</a>[65];       <span class="comment">/* hash(repo_id + passwd), key stretched. */</span>
<a name="l00049"></a><a class="code" href="struct__SeafRepo.html#a83e0a2366ba320396f2deb6faa167b84">00049</a>     gchar       <a class="code" href="struct__SeafRepo.html#a83e0a2366ba320396f2deb6faa167b84">random_key</a>[97];  <span class="comment">/* key length is 48 after encryption */</span>
<a name="l00050"></a><a class="code" href="struct__SeafRepo.html#a4710aaee11c7887df402fffa7ca6c54f">00050</a>     gboolean    <a class="code" href="struct__SeafRepo.html#a4710aaee11c7887df402fffa7ca6c54f">no_local_history</a>;
<a name="l00051"></a>00051 
<a name="l00052"></a><a class="code" href="struct__SeafRepo.html#a8e635ccff244ee483d3b4abe576e388e">00052</a>     <a class="code" href="struct__SeafBranch.html">SeafBranch</a> *<a class="code" href="struct__SeafRepo.html#a8e635ccff244ee483d3b4abe576e388e">head</a>;
<a name="l00053"></a>00053 
<a name="l00054"></a><a class="code" href="struct__SeafRepo.html#a30acbbe15ec4e36a8b3bb31581c333e5">00054</a>     gboolean    <a class="code" href="struct__SeafRepo.html#a30acbbe15ec4e36a8b3bb31581c333e5">is_corrupted</a>;
<a name="l00055"></a><a class="code" href="struct__SeafRepo.html#a1316126e566b3b2c1d444c9a9511b2ff">00055</a>     gboolean    <a class="code" href="struct__SeafRepo.html#a1316126e566b3b2c1d444c9a9511b2ff">delete_pending</a>;
<a name="l00056"></a>00056 
<a name="l00057"></a><a class="code" href="struct__SeafRepo.html#a5ec79fa4b78423415fc5f31b90fa5bd1">00057</a>     gchar      *<a class="code" href="struct__SeafRepo.html#a5ec79fa4b78423415fc5f31b90fa5bd1">relay_id</a>;
<a name="l00058"></a><a class="code" href="struct__SeafRepo.html#a4342ff79933f9cbdbbd34114e5a26df3">00058</a>     gchar      *<a class="code" href="struct__SeafRepo.html#a4342ff79933f9cbdbbd34114e5a26df3">worktree</a>;
<a name="l00059"></a><a class="code" href="struct__SeafRepo.html#a0c328bbabc240a013e03b822a5304933">00059</a>     gboolean    <a class="code" href="struct__SeafRepo.html#a0c328bbabc240a013e03b822a5304933">wt_changed</a>;
<a name="l00060"></a><a class="code" href="struct__SeafRepo.html#a4e7ca0ab7b4a93c318b08dbc7e946bb8">00060</a>     <span class="keywordtype">int</span>         <a class="code" href="struct__SeafRepo.html#a4e7ca0ab7b4a93c318b08dbc7e946bb8">wt_check_time</a>;
<a name="l00061"></a><a class="code" href="struct__SeafRepo.html#aea8a8f2c57241ca9b47ae1e7026b4ea5">00061</a>     <span class="keywordtype">int</span>         <a class="code" href="struct__SeafRepo.html#aea8a8f2c57241ca9b47ae1e7026b4ea5">last_sync_time</a>;
<a name="l00062"></a>00062 
<a name="l00063"></a>00063     <span class="comment">/* Last time check locked files. */</span>
<a name="l00064"></a><a class="code" href="struct__SeafRepo.html#a96199d89e3f0105139c4d94d568c7208">00064</a>     <span class="keywordtype">int</span>         <a class="code" href="struct__SeafRepo.html#a96199d89e3f0105139c4d94d568c7208">last_check_locked_time</a>;
<a name="l00065"></a><a class="code" href="struct__SeafRepo.html#a772a296124f0a505659064406232dfe2">00065</a>     gboolean    <a class="code" href="struct__SeafRepo.html#a772a296124f0a505659064406232dfe2">checking_locked_files</a>;
<a name="l00066"></a>00066 
<a name="l00067"></a><a class="code" href="struct__SeafRepo.html#ad951f63e287f0ea14c863937afea6779">00067</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__SeafRepo.html#ad951f63e287f0ea14c863937afea6779">enc_key</a>[32];   <span class="comment">/* 256-bit encryption key */</span>
<a name="l00068"></a><a class="code" href="struct__SeafRepo.html#a7ad105e1fab206035f1c585c25e0dc94">00068</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="struct__SeafRepo.html#a7ad105e1fab206035f1c585c25e0dc94">enc_iv</a>[16];
<a name="l00069"></a>00069 
<a name="l00070"></a><a class="code" href="struct__SeafRepo.html#aaeff5900edfc0f7bcb9c97592b70d247">00070</a>     gchar      *<a class="code" href="struct__SeafRepo.html#aaeff5900edfc0f7bcb9c97592b70d247">email</a>;          <span class="comment">/* email of the user on the relay */</span>
<a name="l00071"></a><a class="code" href="struct__SeafRepo.html#a0ce3b61cb31e78ffea429615379b3eb4">00071</a>     gchar      *<a class="code" href="struct__SeafRepo.html#a0ce3b61cb31e78ffea429615379b3eb4">token</a>;          <span class="comment">/* token for access this repo on server */</span>
<a name="l00072"></a>00072 
<a name="l00073"></a><a class="code" href="struct__SeafRepo.html#aaa93119bb8b7b6038e9feb3c3a78b0ab">00073</a>     pthread_mutex_t <a class="code" href="struct__SeafRepo.html#aaa93119bb8b7b6038e9feb3c3a78b0ab">lock</a>;
<a name="l00074"></a>00074 
<a name="l00075"></a><a class="code" href="struct__SeafRepo.html#aeedd453a6f0cf0f3f8104bd2c04d0488">00075</a>     gboolean      <a class="code" href="struct__SeafRepo.html#aeedd453a6f0cf0f3f8104bd2c04d0488">worktree_invalid</a>; <span class="comment">/* true if worktree moved or deleted */</span>
<a name="l00076"></a><a class="code" href="struct__SeafRepo.html#a5377f474b9e1cc96a69ab26d5da8e244">00076</a>     gboolean      <a class="code" href="struct__SeafRepo.html#a5377f474b9e1cc96a69ab26d5da8e244">index_corrupted</a>;
<a name="l00077"></a><a class="code" href="struct__SeafRepo.html#acde5aeaa410508f873ecaecd9da4c681">00077</a>     gboolean      <a class="code" href="struct__SeafRepo.html#acde5aeaa410508f873ecaecd9da4c681">is_readonly</a>;
<a name="l00078"></a>00078 
<a name="l00079"></a><a class="code" href="struct__SeafRepo.html#a179d8ca9672a5eeafcbf535d0ccee45d">00079</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  <a class="code" href="struct__SeafRepo.html#a179d8ca9672a5eeafcbf535d0ccee45d">auto_sync</a> : 1;
<a name="l00080"></a><a class="code" href="struct__SeafRepo.html#a575e562d38b7fc0adc79a6b24ea00ac1">00080</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  <a class="code" href="struct__SeafRepo.html#a575e562d38b7fc0adc79a6b24ea00ac1">net_browsable</a> : 1;
<a name="l00081"></a><a class="code" href="struct__SeafRepo.html#a11dafeec06d10af805448ba5e11a7693">00081</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  <a class="code" href="struct__SeafRepo.html#a11dafeec06d10af805448ba5e11a7693">quota_full_notified</a> : 1;
<a name="l00082"></a><a class="code" href="struct__SeafRepo.html#ad40b148677957cac652258ee67c68358">00082</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  <a class="code" href="struct__SeafRepo.html#ad40b148677957cac652258ee67c68358">access_denied_notified</a> : 1;
<a name="l00083"></a>00083 
<a name="l00084"></a><a class="code" href="struct__SeafRepo.html#ab75d342176657e7504c5cddd5ca2c56a">00084</a>     <span class="keywordtype">int</span> <a class="code" href="struct__SeafRepo.html#ab75d342176657e7504c5cddd5ca2c56a">version</a>;
<a name="l00085"></a>00085 
<a name="l00086"></a><a class="code" href="struct__SeafRepo.html#ae55dc691d150f9eef30f3f942d8dacca">00086</a>     gboolean <a class="code" href="struct__SeafRepo.html#ae55dc691d150f9eef30f3f942d8dacca">create_partial_commit</a>;
<a name="l00087"></a>00087 
<a name="l00088"></a>00088     <span class="comment">/* Used for http sync. */</span>
<a name="l00089"></a><a class="code" href="struct__SeafRepo.html#a1a7beee19acb913be2c23ac0e71ea733">00089</a>     <span class="keywordtype">char</span> *<a class="code" href="struct__SeafRepo.html#a1a7beee19acb913be2c23ac0e71ea733">server_url</a>;
<a name="l00090"></a>00090 };
<a name="l00091"></a>00091 
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 gboolean <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a35ce9f51287bbd5f961c261516c1c5f0">is_repo_id_valid</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span>);
<a name="l00094"></a>00094 
<a name="l00095"></a>00095 <a class="code" href="struct__SeafRepo.html">SeafRepo</a>* 
<a name="l00096"></a>00096 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a63ab9fe4694e3d967376c911cbe2c655">seaf_repo_new</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span>, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="index_8h.html#a2a7f851274ec18e17d38114c39b8511a">name</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *desc);
<a name="l00097"></a>00097 
<a name="l00098"></a>00098 <span class="keywordtype">void</span>
<a name="l00099"></a>00099 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#ad0a65514ad80789ff244b20c66460b96">seaf_repo_free</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo);
<a name="l00100"></a>00100 
<a name="l00101"></a>00101 <span class="keywordtype">int</span>
<a name="l00102"></a>00102 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a6c47d6277897f6afbe866f2755f9762d">seaf_repo_set_head</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo, <a class="code" href="struct__SeafBranch.html">SeafBranch</a> *branch);
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 <a class="code" href="struct__SeafCommit.html">SeafCommit</a> *
<a name="l00105"></a>00105 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a7fdd2ba98b2cab98aaced0e49a1685a9">seaf_repo_get_head_commit</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id);
<a name="l00106"></a>00106 
<a name="l00107"></a>00107 <span class="keywordtype">void</span>
<a name="l00108"></a>00108 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a01b64563a9ab1351f8a9626c86ff8d6a">seaf_repo_set_readonly</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo);
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 <span class="keywordtype">void</span>
<a name="l00111"></a>00111 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#af712f7a4551fbc0dfa780f3aada0a029">seaf_repo_unset_readonly</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo);
<a name="l00112"></a>00112 
<a name="l00113"></a>00113 <span class="keywordtype">int</span>
<a name="l00114"></a>00114 <a class="code" href="daemon_2repo-mgr_8h.html#accda8da47680fe67a6ddb905b8279c77">seaf_repo_checkdir</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo);
<a name="l00115"></a>00115 
<a name="l00116"></a>00116 <span class="comment">/* Update repo name, desc, magic etc from commit.</span>
<a name="l00117"></a>00117 <span class="comment"> */</span>
<a name="l00118"></a>00118 <span class="keywordtype">void</span>
<a name="l00119"></a>00119 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a9c8ead9892374c87ece888d76e810197">seaf_repo_from_commit</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo, <a class="code" href="struct__SeafCommit.html">SeafCommit</a> *commit);
<a name="l00120"></a>00120 
<a name="l00121"></a>00121 <span class="comment">/* Update repo-related fields to commit. </span>
<a name="l00122"></a>00122 <span class="comment"> */</span>
<a name="l00123"></a>00123 <span class="keywordtype">void</span>
<a name="l00124"></a>00124 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a39a9a41ffdfc324f3c935251d9e14d51">seaf_repo_to_commit</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo, <a class="code" href="struct__SeafCommit.html">SeafCommit</a> *commit);
<a name="l00125"></a>00125 
<a name="l00126"></a>00126 <span class="comment">/*</span>
<a name="l00127"></a>00127 <span class="comment"> * Returns a list of all commits belongs to the repo.</span>
<a name="l00128"></a>00128 <span class="comment"> * The commits in the repos are all unique.</span>
<a name="l00129"></a>00129 <span class="comment"> */</span>
<a name="l00130"></a>00130 GList *
<a name="l00131"></a>00131 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#adc55911231fbdbb9d54f39d7f0e60dca">seaf_repo_get_commits</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo);
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 <span class="keywordtype">int</span>
<a name="l00134"></a>00134 <a class="code" href="daemon_2repo-mgr_8h.html#a4d6eb650ab68ba1720c02b9353066eb7">seaf_repo_index_add</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo, <span class="keyword">const</span> <span class="keywordtype">char</span> *path);
<a name="l00135"></a>00135 
<a name="l00136"></a>00136 <span class="keywordtype">int</span>
<a name="l00137"></a>00137 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#aadbf4eb74b53f6423e7eabf716f5f4fb">seaf_repo_index_worktree_files</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id,
<a name="l00138"></a>00138                                 <span class="keywordtype">int</span> <a class="code" href="block-tx-utils_8h.html#a1abe2c64ac9f8bc05bbb1719cad360f3">version</a>,
<a name="l00139"></a>00139                                 <span class="keyword">const</span> <span class="keywordtype">char</span> *modifier,
<a name="l00140"></a>00140                                 <span class="keyword">const</span> <span class="keywordtype">char</span> *worktree,
<a name="l00141"></a>00141                                 <span class="keyword">const</span> <span class="keywordtype">char</span> *passwd,
<a name="l00142"></a>00142                                 <span class="keywordtype">int</span> enc_version,
<a name="l00143"></a>00143                                 <span class="keyword">const</span> <span class="keywordtype">char</span> *random_key,
<a name="l00144"></a>00144                                 <span class="keywordtype">char</span> *root_id);
<a name="l00145"></a>00145 
<a name="l00146"></a>00146 <span class="keywordtype">int</span>
<a name="l00147"></a>00147 <a class="code" href="daemon_2repo-mgr_8h.html#aba396fcff962b3ed461aa884db0d484c">seaf_repo_index_rm</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo, <span class="keyword">const</span> <span class="keywordtype">char</span> *path);
<a name="l00148"></a>00148 
<a name="l00149"></a>00149 <span class="keywordtype">char</span> *
<a name="l00150"></a>00150 <a class="code" href="daemon_2repo-mgr_8h.html#a47cf4677f4c176aa29a50e7401e58733">seaf_repo_status</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo);
<a name="l00151"></a>00151 
<a name="l00152"></a>00152 gboolean
<a name="l00153"></a>00153 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a461e72948bba5928329e269ad395e293">seaf_repo_is_worktree_changed</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo);
<a name="l00154"></a>00154 
<a name="l00155"></a>00155 gboolean
<a name="l00156"></a>00156 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a79db93d798035e3e07f48c2ad32d87f1">seaf_repo_is_index_unmerged</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo);
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 <span class="keywordtype">char</span> *
<a name="l00159"></a>00159 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#af591ba84286a82123c728debd33ff300">seaf_repo_index_commit</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo, <span class="keyword">const</span> <span class="keywordtype">char</span> *desc, gboolean is_initial_commit,
<a name="l00160"></a>00160                         GError **error);
<a name="l00161"></a>00161 
<a name="l00162"></a>00162 <span class="keywordtype">int</span>
<a name="l00163"></a>00163 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a888b4c185cc198eaf4eb7d4d3b8e9054">seaf_repo_checkout</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo, <span class="keyword">const</span> <span class="keywordtype">char</span> *worktree_parent, <span class="keywordtype">char</span> **error);
<a name="l00164"></a>00164 
<a name="l00165"></a>00165 <span class="keywordtype">int</span>
<a name="l00166"></a>00166 <a class="code" href="daemon_2repo-mgr_8h.html#a9f5b276ce779be3680db671b6c57864b">seaf_repo_reset</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo, <span class="keyword">const</span> <span class="keywordtype">char</span> *commit_id, <span class="keywordtype">char</span> **error);
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 <span class="keywordtype">int</span>
<a name="l00169"></a>00169 <a class="code" href="daemon_2repo-mgr_8h.html#a010789e19777e216f82d17ae1b2baad5">seaf_repo_revert</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo, <span class="keyword">const</span> <span class="keywordtype">char</span> *commit_id, <span class="keywordtype">char</span> **error);
<a name="l00170"></a>00170 
<a name="l00171"></a>00171 <span class="keywordtype">int</span>
<a name="l00172"></a>00172 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a7923c5fb7b957a121f1b2616a8d66745">seaf_repo_checkout_commit</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo, <a class="code" href="struct__SeafCommit.html">SeafCommit</a> *commit, gboolean recover_merge,
<a name="l00173"></a>00173                            <span class="keywordtype">char</span> **error);
<a name="l00174"></a>00174 
<a name="l00175"></a>00175 <span class="keyword">enum</span> {
<a name="l00176"></a><a class="code" href="daemon_2repo-mgr_8h.html#ab48899087cc647f0f791ed0c459adc53a1371483176999a269b4a25a940f45613">00176</a>     <a class="code" href="daemon_2repo-mgr_8h.html#ab48899087cc647f0f791ed0c459adc53a1371483176999a269b4a25a940f45613">MERGE_STATUS_UNKNOWN</a> = 0,
<a name="l00177"></a><a class="code" href="daemon_2repo-mgr_8h.html#ab48899087cc647f0f791ed0c459adc53a06828bd6cd4c8965ecca5747bf0d582f">00177</a>     <a class="code" href="daemon_2repo-mgr_8h.html#ab48899087cc647f0f791ed0c459adc53a06828bd6cd4c8965ecca5747bf0d582f">MERGE_STATUS_UPTODATE</a>,
<a name="l00178"></a><a class="code" href="daemon_2repo-mgr_8h.html#ab48899087cc647f0f791ed0c459adc53ae88b9f0b426e62748bda17f4cdda0400">00178</a>     <a class="code" href="daemon_2repo-mgr_8h.html#ab48899087cc647f0f791ed0c459adc53ae88b9f0b426e62748bda17f4cdda0400">MERGE_STATUS_FAST_FORWARD</a>,
<a name="l00179"></a><a class="code" href="daemon_2repo-mgr_8h.html#ab48899087cc647f0f791ed0c459adc53a838e7d086c148e6873ba7408ec010b53">00179</a>     <a class="code" href="daemon_2repo-mgr_8h.html#ab48899087cc647f0f791ed0c459adc53a838e7d086c148e6873ba7408ec010b53">MERGE_STATUS_REAL_MERGE</a>,
<a name="l00180"></a>00180 };
<a name="l00181"></a>00181 
<a name="l00182"></a>00182 <span class="keywordtype">int</span>
<a name="l00183"></a>00183 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a25b9a6f8f5199db34dcb95789a80eba4">seaf_repo_merge</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo, <span class="keyword">const</span> <span class="keywordtype">char</span> *branch, <span class="keywordtype">char</span> **error,
<a name="l00184"></a>00184                  <span class="keywordtype">int</span> *merge_status);
<a name="l00185"></a>00185 
<a name="l00186"></a>00186 GList *
<a name="l00187"></a>00187 <a class="code" href="daemon_2repo-mgr_8h.html#a299584e10b999b26497ff01a8b87a981">seaf_repo_diff</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo, <span class="keyword">const</span> <span class="keywordtype">char</span> *arg1, <span class="keyword">const</span> <span class="keywordtype">char</span> *arg2, <span class="keywordtype">char</span> **error);
<a name="l00188"></a>00188 
<a name="l00189"></a><a class="code" href="daemon_2repo-mgr_8h.html#af5833aac28a20ee1e1217fc33b9c3a54">00189</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__SeafRepoManager.html">_SeafRepoManager</a> <a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a>;
<a name="l00190"></a><a class="code" href="daemon_2repo-mgr_8h.html#a4c34a185eca37d07c53358b27bd439f2">00190</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__SeafRepoManagerPriv.html">_SeafRepoManagerPriv</a> <a class="code" href="struct__SeafRepoManagerPriv.html">SeafRepoManagerPriv</a>;
<a name="l00191"></a>00191 
<a name="l00192"></a><a class="code" href="struct__SeafRepoManager.html">00192</a> <span class="keyword">struct </span><a class="code" href="struct__SeafRepoManager.html">_SeafRepoManager</a> {
<a name="l00193"></a><a class="code" href="struct__SeafRepoManager.html#a16f3c4659df75ed4fe76acba492f1865">00193</a>     <span class="keyword">struct </span><a class="code" href="struct__SeafileSession.html">_SeafileSession</a> *<a class="code" href="struct__SeafRepoManager.html#a16f3c4659df75ed4fe76acba492f1865">seaf</a>;
<a name="l00194"></a>00194 
<a name="l00195"></a><a class="code" href="struct__SeafRepoManager.html#a24a8835becd3d59636e13e5cc0cfc365">00195</a>     <span class="keywordtype">char</span> *<a class="code" href="struct__SeafRepoManager.html#a24a8835becd3d59636e13e5cc0cfc365">index_dir</a>;
<a name="l00196"></a>00196 
<a name="l00197"></a><a class="code" href="struct__SeafRepoManager.html#afeb589ad01ce0797c851f27b348c94ad">00197</a>     <a class="code" href="struct__SeafRepoManagerPriv.html">SeafRepoManagerPriv</a> *<a class="code" href="struct__SeafRepoManager.html#afeb589ad01ce0797c851f27b348c94ad">priv</a>;
<a name="l00198"></a>00198 };
<a name="l00199"></a>00199 
<a name="l00200"></a>00200 <a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a>* 
<a name="l00201"></a>00201 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a8f91693d20dfa77546527064cb1097e3">seaf_repo_manager_new</a> (<span class="keyword">struct</span> <a class="code" href="struct__SeafileSession.html">_SeafileSession</a> *<a class="code" href="seaf-daemon_8c.html#ae66636d1834d105bd51d89ff01acfe15">seaf</a>);
<a name="l00202"></a>00202 
<a name="l00203"></a>00203 <span class="keywordtype">int</span>
<a name="l00204"></a>00204 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a8dab773e289d1148e7afec7c8614278a">seaf_repo_manager_init</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr);
<a name="l00205"></a>00205 
<a name="l00206"></a>00206 <span class="keywordtype">int</span>
<a name="l00207"></a>00207 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a2e049cfa3d0546aaf51e7f6792e1467d">seaf_repo_manager_start</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr);
<a name="l00208"></a>00208 
<a name="l00209"></a>00209 <span class="keywordtype">int</span>
<a name="l00210"></a>00210 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a140616a89d5a02935665f86cf3bb744c">seaf_repo_manager_add_repo</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr, <a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo);
<a name="l00211"></a>00211 
<a name="l00212"></a>00212 <span class="keywordtype">int</span>
<a name="l00213"></a>00213 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#ad41b6fcdbf4fdfa7d70daf98af124460">seaf_repo_manager_mark_repo_deleted</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr, <a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo);
<a name="l00214"></a>00214 
<a name="l00215"></a>00215 <span class="keywordtype">int</span>
<a name="l00216"></a>00216 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#afdce2de6ee36dcf6b6264ac35fb17f7a">seaf_repo_manager_del_repo</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr, <a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo);
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 <span class="keywordtype">void</span>
<a name="l00219"></a>00219 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a008f145440cf3620f7883d1fe109f69c">seaf_repo_manager_remove_repo_ondisk</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr, <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id,
<a name="l00220"></a>00220                                       gboolean add_deleted_record);
<a name="l00221"></a>00221 
<a name="l00222"></a>00222 <a class="code" href="struct__SeafRepo.html">SeafRepo</a>* 
<a name="l00223"></a>00223 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#ab599ba29e40bdb918ac78060d1165c2d">seaf_repo_manager_create_new_repo</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr,
<a name="l00224"></a>00224                                    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="index_8h.html#a2a7f851274ec18e17d38114c39b8511a">name</a>,
<a name="l00225"></a>00225                                    <span class="keyword">const</span> <span class="keywordtype">char</span> *desc);
<a name="l00226"></a>00226 
<a name="l00227"></a>00227 <a class="code" href="struct__SeafRepo.html">SeafRepo</a>* 
<a name="l00228"></a>00228 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#af0276c036723560e3e8b9aa5529133d6">seaf_repo_manager_get_repo</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager, <span class="keyword">const</span> gchar *<span class="keywordtype">id</span>);
<a name="l00229"></a>00229 
<a name="l00230"></a>00230 gboolean
<a name="l00231"></a>00231 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a4b2497e6cdde50c4ce3cb642370e06eb">seaf_repo_manager_repo_exists</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager, <span class="keyword">const</span> gchar *<span class="keywordtype">id</span>);
<a name="l00232"></a>00232 
<a name="l00233"></a>00233 GList* 
<a name="l00234"></a>00234 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a5fe41fb7382995f3f335e408ba4ddb30">seaf_repo_manager_get_repo_list</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr, <span class="keywordtype">int</span> start, <span class="keywordtype">int</span> limit);
<a name="l00235"></a>00235 
<a name="l00236"></a>00236 GList *
<a name="l00237"></a>00237 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#ae45351706ea0868c8e6c9bad500e1785">seaf_repo_manager_list_garbage_repos</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr);
<a name="l00238"></a>00238 
<a name="l00239"></a>00239 <span class="keywordtype">void</span>
<a name="l00240"></a>00240 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a7d2cf85f06fa2e7d459730f7494c1a65">seaf_repo_manager_remove_garbage_repo</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr, <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id);
<a name="l00241"></a>00241 
<a name="l00242"></a><a class="code" href="daemon_2repo-mgr_8h.html#a1d3305b8bae92ef04cfac74707b663d7">00242</a> <span class="preprocessor">#define MAX_REPO_TOKEN 64</span>
<a name="l00243"></a><a class="code" href="daemon_2repo-mgr_8h.html#afa2f07ad83586c04020cc7fa2760ff1a">00243</a> <span class="preprocessor"></span><span class="preprocessor">#define DEFAULT_REPO_TOKEN &quot;default&quot;</span>
<a name="l00244"></a>00244 <span class="preprocessor"></span>
<a name="l00245"></a>00245 
<a name="l00246"></a>00246 <span class="keywordtype">int</span>
<a name="l00247"></a>00247 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a4fdafbeb326de99eec7160b72bcc3dd4">seaf_repo_manager_set_repo_token</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager, 
<a name="l00248"></a>00248                                   <a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo,
<a name="l00249"></a>00249                                   <span class="keyword">const</span> <span class="keywordtype">char</span> *token);
<a name="l00250"></a>00250 
<a name="l00251"></a>00251 <span class="keywordtype">int</span>
<a name="l00252"></a>00252 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#abbca41e16d1632518aedb8cbe31199b5">seaf_repo_manager_remove_repo_token</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager,
<a name="l00253"></a>00253                                      <a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo);
<a name="l00254"></a>00254 
<a name="l00255"></a>00255 <span class="keywordtype">int</span>
<a name="l00256"></a>00256 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a4f525e2d8e12d4d8afab74b4291c24d3">seaf_repo_manager_set_repo_email</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager, 
<a name="l00257"></a>00257                                   <a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo,
<a name="l00258"></a>00258                                   <span class="keyword">const</span> <span class="keywordtype">char</span> *email);
<a name="l00259"></a>00259 
<a name="l00260"></a>00260 <span class="keywordtype">int</span>
<a name="l00261"></a>00261 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a8539157b5ddbb1e183886ac3f03b0f0d">seaf_repo_manager_set_repo_relay_info</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager, 
<a name="l00262"></a>00262                                        <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id,
<a name="l00263"></a>00263                                        <span class="keyword">const</span> <span class="keywordtype">char</span> *relay_addr,
<a name="l00264"></a>00264                                        <span class="keyword">const</span> <span class="keywordtype">char</span> *relay_port);
<a name="l00265"></a>00265 <span class="keywordtype">void</span>
<a name="l00266"></a>00266 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a018177d17e765b6b8519f6537650e1cc">seaf_repo_manager_get_repo_relay_info</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr,
<a name="l00267"></a>00267                                        <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id,
<a name="l00268"></a>00268                                        <span class="keywordtype">char</span> **relay_addr,
<a name="l00269"></a>00269                                        <span class="keywordtype">char</span> **relay_port);
<a name="l00270"></a>00270 
<a name="l00271"></a>00271 <span class="keywordtype">int</span>
<a name="l00272"></a>00272 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#ae586fb5fbd61d6b44be3e47e7b6c86da">seaf_repo_manager_branch_repo_unmap</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager, <a class="code" href="struct__SeafBranch.html">SeafBranch</a> *branch);
<a name="l00273"></a>00273 
<a name="l00274"></a>00274 <span class="keywordtype">char</span> *
<a name="l00275"></a>00275 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a45b0ed6bbbdfac4fd104962800f426c3">seaf_repo_manager_get_repo_lantoken</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager,
<a name="l00276"></a>00276                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id);
<a name="l00277"></a>00277 <span class="keywordtype">int</span>
<a name="l00278"></a>00278 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a93b2f3d8f0964708f8fb0450fded2a42">seaf_repo_manager_set_repo_lantoken</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager,
<a name="l00279"></a>00279                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id,
<a name="l00280"></a>00280                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *token);
<a name="l00281"></a>00281 <span class="keywordtype">int</span>
<a name="l00282"></a>00282 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a297f8a46a2390465725298d9a08c1145">seaf_repo_manager_verify_repo_lantoken</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager,
<a name="l00283"></a>00283                                         <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id,
<a name="l00284"></a>00284                                         <span class="keyword">const</span> <span class="keywordtype">char</span> *token);
<a name="l00285"></a>00285 
<a name="l00286"></a>00286 <span class="keywordtype">char</span> *
<a name="l00287"></a>00287 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#afebb8831a3f9be12c5612c5707118d3b">seaf_repo_manager_generate_tmp_token</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager,
<a name="l00288"></a>00288                                       <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id,
<a name="l00289"></a>00289                                       <span class="keyword">const</span> <span class="keywordtype">char</span> *peer_id);
<a name="l00290"></a>00290 
<a name="l00291"></a>00291 <span class="keywordtype">int</span>
<a name="l00292"></a>00292 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#ae27495cf631eca68cf5e94048b7e66f2">seaf_repo_manager_verify_tmp_token</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager,
<a name="l00293"></a>00293                                     <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id,
<a name="l00294"></a>00294                                     <span class="keyword">const</span> <span class="keywordtype">char</span> *peer_id,
<a name="l00295"></a>00295                                     <span class="keyword">const</span> <span class="keywordtype">char</span> *token);
<a name="l00296"></a>00296 
<a name="l00297"></a>00297 <span class="keywordtype">int</span>
<a name="l00298"></a>00298 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a9d2f586c85f26b2de677fd03606103aa">seaf_repo_manager_set_repo_property</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager,
<a name="l00299"></a>00299                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id,
<a name="l00300"></a>00300                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *key,
<a name="l00301"></a>00301                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *value);
<a name="l00302"></a>00302 
<a name="l00303"></a>00303 <span class="keywordtype">char</span> *
<a name="l00304"></a>00304 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a71edf5bba9589fa8793d7b0312cb9553">seaf_repo_manager_get_repo_property</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager,
<a name="l00305"></a>00305                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id,
<a name="l00306"></a>00306                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *key);
<a name="l00307"></a>00307 
<a name="l00308"></a>00308 <span class="keywordtype">void</span>
<a name="l00309"></a>00309 <a class="code" href="daemon_2repo-mgr_8h.html#ace7ce05d76c4dec01f3278200468bd39">seaf_repo_mamager_del_repo_property</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager, <a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo);
<a name="l00310"></a>00310 
<a name="l00311"></a>00311 <span class="keywordtype">int</span>
<a name="l00312"></a>00312 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#ad1200d69d8e6219885da4e85af15dca2">seaf_repo_check_worktree</a> (<a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo);
<a name="l00313"></a>00313 
<a name="l00314"></a>00314 <span class="keywordtype">int</span>
<a name="l00315"></a>00315 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a6ed05df6501a326fc58a0fefb91aef3d">seaf_repo_manager_set_repo_worktree</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr,
<a name="l00316"></a>00316                                      <a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo,
<a name="l00317"></a>00317                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *worktree);
<a name="l00318"></a>00318 
<a name="l00319"></a>00319 <span class="keywordtype">void</span>
<a name="l00320"></a>00320 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a4002175d5613c80a6dd82b95bc1fae24">seaf_repo_manager_invalidate_repo_worktree</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr,
<a name="l00321"></a>00321                                             <a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo);
<a name="l00322"></a>00322 
<a name="l00323"></a>00323 <span class="keywordtype">void</span>
<a name="l00324"></a>00324 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a8299b47936df15cd58ba2ae41e344450">seaf_repo_manager_validate_repo_worktree</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr,
<a name="l00325"></a>00325                                           <a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo);
<a name="l00326"></a>00326 
<a name="l00327"></a>00327 <span class="keywordtype">int</span>
<a name="l00328"></a>00328 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a683d25df06076d282da2f7ae01e05a49">seaf_repo_manager_set_repo_passwd</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager,
<a name="l00329"></a>00329                                    <a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo,
<a name="l00330"></a>00330                                    <span class="keyword">const</span> <span class="keywordtype">char</span> *passwd);
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 <span class="keywordtype">int</span>
<a name="l00333"></a>00333 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#ad2263393047e4ea1f5226842b11e7b05">seaf_repo_manager_set_repo_relay_id</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr,
<a name="l00334"></a>00334                                      <a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo,
<a name="l00335"></a>00335                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *relay_id);
<a name="l00336"></a>00336 
<a name="l00337"></a>00337 <span class="keywordtype">int</span>
<a name="l00338"></a>00338 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a2e382a4324579845c975befc11cccda2">seaf_repo_manager_set_merge</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager,
<a name="l00339"></a>00339                              <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id,
<a name="l00340"></a>00340                              <span class="keyword">const</span> <span class="keywordtype">char</span> *remote_head);
<a name="l00341"></a>00341 
<a name="l00342"></a>00342 <span class="keywordtype">int</span>
<a name="l00343"></a>00343 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a04253ac87d4466bd4e2abd1e312a1663">seaf_repo_manager_clear_merge</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager,
<a name="l00344"></a>00344                                <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id);
<a name="l00345"></a>00345 
<a name="l00346"></a><a class="code" href="structSeafRepoMergeInfo.html">00346</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00347"></a><a class="code" href="structSeafRepoMergeInfo.html#a511f64caf502d7e67b2ce2d838c5fa51">00347</a>     gboolean <a class="code" href="structSeafRepoMergeInfo.html#a511f64caf502d7e67b2ce2d838c5fa51">in_merge</a>;
<a name="l00348"></a><a class="code" href="structSeafRepoMergeInfo.html#a1f6af16dd70282a1c33333a4b6520219">00348</a>     <span class="keywordtype">char</span> remote_head[41];
<a name="l00349"></a>00349 } <a class="code" href="structSeafRepoMergeInfo.html">SeafRepoMergeInfo</a>;
<a name="l00350"></a>00350 
<a name="l00351"></a>00351 <span class="keywordtype">int</span>
<a name="l00352"></a>00352 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#ac0e4e52af419d42f34ce53d368777070">seaf_repo_manager_get_merge_info</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager,
<a name="l00353"></a>00353                                   <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id,
<a name="l00354"></a>00354                                   <a class="code" href="structSeafRepoMergeInfo.html">SeafRepoMergeInfo</a> *info);
<a name="l00355"></a>00355 
<a name="l00356"></a>00356 <span class="keywordtype">int</span>
<a name="l00357"></a>00357 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a3d8affa43a26075cdd6821e330f68748">seaf_repo_manager_get_common_ancestor</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager,
<a name="l00358"></a>00358                                        <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id,
<a name="l00359"></a>00359                                        <span class="keywordtype">char</span> *common_ancestor,
<a name="l00360"></a>00360                                        <span class="keywordtype">char</span> *head_id);
<a name="l00361"></a>00361 
<a name="l00362"></a>00362 <span class="keywordtype">int</span>
<a name="l00363"></a>00363 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#af2f71495e665325efae99d4beb03deb5">seaf_repo_manager_set_common_ancestor</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *manager,
<a name="l00364"></a>00364                                        <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id,
<a name="l00365"></a>00365                                        <span class="keyword">const</span> <span class="keywordtype">char</span> *common_ancestor,
<a name="l00366"></a>00366                                        <span class="keyword">const</span> <span class="keywordtype">char</span> *head_id);
<a name="l00367"></a>00367 
<a name="l00368"></a><a class="code" href="structCheckoutTask.html">00368</a> <span class="keyword">typedef</span> <span class="keyword">struct </span>{
<a name="l00369"></a><a class="code" href="structCheckoutTask.html#a84eafe72ec4243ad00e41f6fd8a9050b">00369</a>     <span class="keywordtype">char</span> repo_id[41];
<a name="l00370"></a><a class="code" href="structCheckoutTask.html#a26041098da1295d02fe5c82b35deb75d">00370</a>     <span class="keywordtype">char</span> worktree[<a class="code" href="seafile-4_81_82_2common_2common_8h.html#a169a119979344433b9e2a39e4e8e334a">SEAF_PATH_MAX</a>];
<a name="l00371"></a><a class="code" href="structCheckoutTask.html#a91c93d2e31b4ce625dcfd7e98a0b1c4f">00371</a>     <span class="keywordtype">int</span> <a class="code" href="structCheckoutTask.html#a91c93d2e31b4ce625dcfd7e98a0b1c4f">total_files</a>;
<a name="l00372"></a><a class="code" href="structCheckoutTask.html#a870604697553d88bc67e5a3b4ef0549b">00372</a>     <span class="keywordtype">int</span> <a class="code" href="structCheckoutTask.html#a870604697553d88bc67e5a3b4ef0549b">finished_files</a>;
<a name="l00373"></a><a class="code" href="structCheckoutTask.html#a1a6e214f7718e025a661ded5f5b9214d">00373</a>     gboolean <a class="code" href="structCheckoutTask.html#a1a6e214f7718e025a661ded5f5b9214d">success</a>;
<a name="l00374"></a>00374 } <a class="code" href="structCheckoutTask.html">CheckoutTask</a>;
<a name="l00375"></a>00375 
<a name="l00376"></a><a class="code" href="daemon_2repo-mgr_8h.html#a699bd5e643ce774eaebfc58876713669">00376</a> <span class="keyword">typedef</span> void (*<a class="code" href="daemon_2repo-mgr_8h.html#a699bd5e643ce774eaebfc58876713669">CheckoutDoneCallback</a>) (<a class="code" href="structCheckoutTask.html">CheckoutTask</a> *, <a class="code" href="struct__SeafRepo.html">SeafRepo</a> *, <span class="keywordtype">void</span> *);
<a name="l00377"></a>00377 
<a name="l00378"></a>00378 <span class="keywordtype">int</span>
<a name="l00379"></a>00379 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#ae2b1438737e8d1bebeb1e674013b02b5">seaf_repo_manager_add_checkout_task</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr,
<a name="l00380"></a>00380                                      <a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo,
<a name="l00381"></a>00381                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *worktree,
<a name="l00382"></a>00382                                      <a class="code" href="daemon_2repo-mgr_8h.html#a699bd5e643ce774eaebfc58876713669">CheckoutDoneCallback</a> done_cb,
<a name="l00383"></a>00383                                      <span class="keywordtype">void</span> *cb_data);
<a name="l00384"></a>00384 
<a name="l00385"></a>00385 <span class="comment">/* Remove all the files in the worktree and then checkout again.</span>
<a name="l00386"></a>00386 <span class="comment"> * Can be used to re-checkout if wrong password was given.</span>
<a name="l00387"></a>00387 <span class="comment"> */</span>
<a name="l00388"></a>00388 <span class="keywordtype">int</span>
<a name="l00389"></a>00389 <a class="code" href="daemon_2repo-mgr_8h.html#a29a995e1b4c7288841268d2dab81372d">seaf_repo_manager_add_recheckout_task</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr,
<a name="l00390"></a>00390                                        <a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo,
<a name="l00391"></a>00391                                        <a class="code" href="daemon_2repo-mgr_8h.html#a699bd5e643ce774eaebfc58876713669">CheckoutDoneCallback</a> done_cb,
<a name="l00392"></a>00392                                        <span class="keywordtype">void</span> *cb_data);
<a name="l00393"></a>00393 
<a name="l00394"></a>00394 <a class="code" href="structCheckoutTask.html">CheckoutTask</a> *
<a name="l00395"></a>00395 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#abe8b32b343e5e7d2d06018e398011151">seaf_repo_manager_get_checkout_task</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr,
<a name="l00396"></a>00396                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id);
<a name="l00397"></a>00397 <span class="keywordtype">int</span>
<a name="l00398"></a>00398 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#aaca4b8f68d91db58fc8e1484d9695ce6">seaf_repo_manager_update_repo_relay_info</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr,
<a name="l00399"></a>00399                                           <a class="code" href="struct__SeafRepo.html">SeafRepo</a> *repo,
<a name="l00400"></a>00400                                           <span class="keyword">const</span> <span class="keywordtype">char</span> *new_addr,
<a name="l00401"></a>00401                                           <span class="keyword">const</span> <span class="keywordtype">char</span> *new_port);
<a name="l00402"></a>00402 
<a name="l00403"></a>00403 <span class="keywordtype">int</span>
<a name="l00404"></a>00404 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#ae3753999b4845dfe68bd6f098313280c">seaf_repo_manager_update_repos_server_host</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr,
<a name="l00405"></a>00405                                             <span class="keyword">const</span> <span class="keywordtype">char</span> *old_host,
<a name="l00406"></a>00406                                             <span class="keyword">const</span> <span class="keywordtype">char</span> *new_host,
<a name="l00407"></a>00407                                             <span class="keyword">const</span> <span class="keywordtype">char</span> *new_server_url);
<a name="l00408"></a>00408 
<a name="l00409"></a>00409 GList *
<a name="l00410"></a>00410 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#abdf6d76830c08b16b49d76e2f34037a5">seaf_repo_load_ignore_files</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *worktree);
<a name="l00411"></a>00411 
<a name="l00412"></a>00412 gboolean
<a name="l00413"></a>00413 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a32907bbaf9e2790699ddb7aaa97a3052">seaf_repo_check_ignore_file</a> (GList *ignore_list, <span class="keyword">const</span> <span class="keywordtype">char</span> *fullpath);
<a name="l00414"></a>00414 
<a name="l00415"></a>00415 <span class="keywordtype">void</span>
<a name="l00416"></a>00416 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#ae640da4e7db6b316cd0e3c1ba463f9bd">seaf_repo_free_ignore_files</a> (GList *ignore_list);
<a name="l00417"></a>00417 
<a name="l00418"></a>00418 <span class="keyword">enum</span> {
<a name="l00419"></a><a class="code" href="daemon_2repo-mgr_8h.html#a458e651af6690959efa2afb96be7d609a3bd7bd125dc75983ea384746da28fbbb">00419</a>     <a class="code" href="daemon_2repo-mgr_8h.html#a458e651af6690959efa2afb96be7d609a3bd7bd125dc75983ea384746da28fbbb">FETCH_CHECKOUT_SUCCESS</a> = 0,
<a name="l00420"></a><a class="code" href="daemon_2repo-mgr_8h.html#a458e651af6690959efa2afb96be7d609ae2a1e8d995b67343e5162cdb29513380">00420</a>     <a class="code" href="daemon_2repo-mgr_8h.html#a458e651af6690959efa2afb96be7d609ae2a1e8d995b67343e5162cdb29513380">FETCH_CHECKOUT_CANCELED</a>,
<a name="l00421"></a><a class="code" href="daemon_2repo-mgr_8h.html#a458e651af6690959efa2afb96be7d609ac2960941ae6f238c4fbaf2473ce569b7">00421</a>     <a class="code" href="daemon_2repo-mgr_8h.html#a458e651af6690959efa2afb96be7d609ac2960941ae6f238c4fbaf2473ce569b7">FETCH_CHECKOUT_FAILED</a>,
<a name="l00422"></a><a class="code" href="daemon_2repo-mgr_8h.html#a458e651af6690959efa2afb96be7d609a4a1718c70eba70651160111e48589161">00422</a>     <a class="code" href="daemon_2repo-mgr_8h.html#a458e651af6690959efa2afb96be7d609a4a1718c70eba70651160111e48589161">FETCH_CHECKOUT_TRANSFER_ERROR</a>,
<a name="l00423"></a><a class="code" href="daemon_2repo-mgr_8h.html#a458e651af6690959efa2afb96be7d609a662e1ae03ecdd8c6d02c7195e332d3ce">00423</a>     <a class="code" href="daemon_2repo-mgr_8h.html#a458e651af6690959efa2afb96be7d609a662e1ae03ecdd8c6d02c7195e332d3ce">FETCH_CHECKOUT_LOCKED</a>,
<a name="l00424"></a>00424 };
<a name="l00425"></a>00425 
<a name="l00426"></a>00426 <span class="keyword">struct </span><a class="code" href="struct__TransferTask.html">_TransferTask</a>;
<a name="l00427"></a>00427 <span class="keyword">struct </span><a class="code" href="struct__HttpTxTask.html">_HttpTxTask</a>;
<a name="l00428"></a>00428 
<a name="l00429"></a>00429 <span class="keywordtype">int</span>
<a name="l00430"></a>00430 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a3ae125d7fd328d8d141dc38710ffd24e">seaf_repo_fetch_and_checkout</a> (<span class="keyword">struct</span> <a class="code" href="struct__TransferTask.html">_TransferTask</a> *task,
<a name="l00431"></a>00431                               <span class="keyword">struct</span> <a class="code" href="struct__HttpTxTask.html">_HttpTxTask</a> *http_task,
<a name="l00432"></a>00432                               gboolean is_http,
<a name="l00433"></a>00433                               <span class="keyword">const</span> <span class="keywordtype">char</span> *remote_head_id);
<a name="l00434"></a>00434 
<a name="l00435"></a>00435 gboolean
<a name="l00436"></a>00436 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a1705de1c533ed3783c9e7ad4b34f4b96">seaf_repo_manager_is_ignored_hidden_file</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *filename);
<a name="l00437"></a>00437 
<a name="l00438"></a>00438 <span class="comment">/* Locked files. */</span>
<a name="l00439"></a>00439 
<a name="l00440"></a><a class="code" href="daemon_2repo-mgr_8h.html#a73695736a3b6d6bc38b8a7e439dba0b4">00440</a> <span class="preprocessor">#define LOCKED_OP_UPDATE &quot;update&quot;</span>
<a name="l00441"></a><a class="code" href="daemon_2repo-mgr_8h.html#ae9d9b81961c1ed4497f7f808c6be96ed">00441</a> <span class="preprocessor"></span><span class="preprocessor">#define LOCKED_OP_DELETE &quot;delete&quot;</span>
<a name="l00442"></a>00442 <span class="preprocessor"></span>
<a name="l00443"></a><a class="code" href="struct__LockedFile.html">00443</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__LockedFile.html">_LockedFile</a> {
<a name="l00444"></a><a class="code" href="struct__LockedFile.html#abdcab3c93928ff7a61146d497d5e4ec7">00444</a>     <span class="keywordtype">char</span> *<a class="code" href="struct__LockedFile.html#abdcab3c93928ff7a61146d497d5e4ec7">operation</a>;
<a name="l00445"></a><a class="code" href="struct__LockedFile.html#a1e6ec2e3b09c05236c6898df5dc77475">00445</a>     gint64 <a class="code" href="struct__LockedFile.html#a1e6ec2e3b09c05236c6898df5dc77475">old_mtime</a>;
<a name="l00446"></a><a class="code" href="struct__LockedFile.html#aebea73a3294e0a1493195022ffce6f23">00446</a>     <span class="keywordtype">char</span> <a class="code" href="struct__LockedFile.html#aebea73a3294e0a1493195022ffce6f23">file_id</a>[41];
<a name="l00447"></a>00447 } <a class="code" href="daemon_2repo-mgr_8h.html#a12a39343dc26a7f7692652fc43b2d3cb">LockedFile</a>;
<a name="l00448"></a>00448 
<a name="l00449"></a><a class="code" href="struct__LockedFileSet.html">00449</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__LockedFileSet.html">_LockedFileSet</a> {
<a name="l00450"></a><a class="code" href="struct__LockedFileSet.html#ae599e7470165a7f4eaaaefad7bb85c5f">00450</a>     <a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *<a class="code" href="struct__LockedFileSet.html#ae599e7470165a7f4eaaaefad7bb85c5f">mgr</a>;
<a name="l00451"></a><a class="code" href="struct__LockedFileSet.html#ae51031b45e0a18e92898ce33bef301fe">00451</a>     <span class="keywordtype">char</span> <a class="code" href="struct__LockedFileSet.html#ae51031b45e0a18e92898ce33bef301fe">repo_id</a>[37];
<a name="l00452"></a><a class="code" href="struct__LockedFileSet.html#a228bfd2b438cfa59fcf2dbd596ce335a">00452</a>     GHashTable *<a class="code" href="struct__LockedFileSet.html#a228bfd2b438cfa59fcf2dbd596ce335a">locked_files</a>;
<a name="l00453"></a>00453 } <a class="code" href="daemon_2repo-mgr_8h.html#adccaa653ef97d8570cac74163af03002">LockedFileSet</a>;
<a name="l00454"></a>00454 
<a name="l00455"></a>00455 <a class="code" href="struct__LockedFileSet.html">LockedFileSet</a> *
<a name="l00456"></a>00456 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a06294e91365be10d46a356d427f62e07">seaf_repo_manager_get_locked_file_set</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr, <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id);
<a name="l00457"></a>00457 
<a name="l00458"></a>00458 <span class="keywordtype">void</span>
<a name="l00459"></a>00459 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#ab44c57f5e23996e5eb807f7c84f443f5">locked_file_set_free</a> (<a class="code" href="struct__LockedFileSet.html">LockedFileSet</a> *fset);
<a name="l00460"></a>00460 
<a name="l00461"></a>00461 <span class="keywordtype">int</span>
<a name="l00462"></a>00462 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a8782ae78d069d4073a35d981b04a2a88">locked_file_set_add_update</a> (<a class="code" href="struct__LockedFileSet.html">LockedFileSet</a> *fset,
<a name="l00463"></a>00463                             <span class="keyword">const</span> <span class="keywordtype">char</span> *path,
<a name="l00464"></a>00464                             <span class="keyword">const</span> <span class="keywordtype">char</span> *operation,
<a name="l00465"></a>00465                             gint64 old_mtime,
<a name="l00466"></a>00466                             <span class="keyword">const</span> <span class="keywordtype">char</span> *file_id);
<a name="l00467"></a>00467 
<a name="l00468"></a>00468 <span class="keywordtype">int</span>
<a name="l00469"></a>00469 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a4d1dacc802b818970800154a9bc6e3db">locked_file_set_remove</a> (<a class="code" href="struct__LockedFileSet.html">LockedFileSet</a> *fset, <span class="keyword">const</span> <span class="keywordtype">char</span> *path, gboolean db_only);
<a name="l00470"></a>00470 
<a name="l00471"></a>00471 <a class="code" href="struct__LockedFile.html">LockedFile</a> *
<a name="l00472"></a>00472 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a818fec9b8684b386170e39cfe5feff55">locked_file_set_lookup</a> (<a class="code" href="struct__LockedFileSet.html">LockedFileSet</a> *fset, <span class="keyword">const</span> <span class="keywordtype">char</span> *path);
<a name="l00473"></a>00473 
<a name="l00474"></a>00474 <span class="comment">/* Folder Permissions. */</span>
<a name="l00475"></a>00475 
<a name="l00476"></a><a class="code" href="daemon_2repo-mgr_8h.html#aa3928c5df6e4b48d8f0218bc5440ad1a">00476</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="daemon_2repo-mgr_8h.html#aa3928c5df6e4b48d8f0218bc5440ad1a">FolderPermType</a> {
<a name="l00477"></a><a class="code" href="daemon_2repo-mgr_8h.html#aa3928c5df6e4b48d8f0218bc5440ad1aa664ef9343772c1e5e20606d23a2f696a">00477</a>     <a class="code" href="daemon_2repo-mgr_8h.html#aa3928c5df6e4b48d8f0218bc5440ad1aa664ef9343772c1e5e20606d23a2f696a">FOLDER_PERM_TYPE_USER</a> = 0,
<a name="l00478"></a><a class="code" href="daemon_2repo-mgr_8h.html#aa3928c5df6e4b48d8f0218bc5440ad1aa55b4f2e55f412aa138091a6f350d16de">00478</a>     <a class="code" href="daemon_2repo-mgr_8h.html#aa3928c5df6e4b48d8f0218bc5440ad1aa55b4f2e55f412aa138091a6f350d16de">FOLDER_PERM_TYPE_GROUP</a>,
<a name="l00479"></a>00479 } <a class="code" href="daemon_2repo-mgr_8h.html#aa3928c5df6e4b48d8f0218bc5440ad1a">FolderPermType</a>;
<a name="l00480"></a>00480 
<a name="l00481"></a><a class="code" href="struct__FolderPerm.html">00481</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct__FolderPerm.html">_FolderPerm</a> {
<a name="l00482"></a><a class="code" href="struct__FolderPerm.html#a1d44107695fb128bdc7de3a224a69d42">00482</a>     <span class="keywordtype">char</span> *<a class="code" href="struct__FolderPerm.html#a1d44107695fb128bdc7de3a224a69d42">path</a>;
<a name="l00483"></a><a class="code" href="struct__FolderPerm.html#a5032277d09756796f0d26e373383dac6">00483</a>     <span class="keywordtype">char</span> *<a class="code" href="struct__FolderPerm.html#a5032277d09756796f0d26e373383dac6">permission</a>;
<a name="l00484"></a>00484 } <a class="code" href="daemon_2repo-mgr_8h.html#a56a1cab242a6825a469495e61c711aa6">FolderPerm</a>;
<a name="l00485"></a>00485 
<a name="l00486"></a>00486 <span class="keywordtype">void</span>
<a name="l00487"></a>00487 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a16e4a5db024bcc5baf2ef8a3f0623a41">folder_perm_free</a> (<a class="code" href="struct__FolderPerm.html">FolderPerm</a> *perm);
<a name="l00488"></a>00488 
<a name="l00489"></a>00489 <span class="keywordtype">int</span>
<a name="l00490"></a>00490 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a446e8f23cdec415146a604f1b954c1a3">seaf_repo_manager_update_folder_perms</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr,
<a name="l00491"></a>00491                                        <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id,
<a name="l00492"></a>00492                                        <a class="code" href="daemon_2repo-mgr_8h.html#aa3928c5df6e4b48d8f0218bc5440ad1a">FolderPermType</a> <a class="code" href="fs-mgr_8c.html#a65cfc9e13d3352fd9099a0408cba715c">type</a>,
<a name="l00493"></a>00493                                        GList *folder_perms);
<a name="l00494"></a>00494 
<a name="l00495"></a>00495 GList *
<a name="l00496"></a>00496 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#ad00e4e927e8099054e29e532cae9c5e4">seaf_repo_manager_load_folder_perms</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr,
<a name="l00497"></a>00497                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id,
<a name="l00498"></a>00498                                      <a class="code" href="daemon_2repo-mgr_8h.html#aa3928c5df6e4b48d8f0218bc5440ad1a">FolderPermType</a> <a class="code" href="fs-mgr_8c.html#a65cfc9e13d3352fd9099a0408cba715c">type</a>);
<a name="l00499"></a>00499 
<a name="l00500"></a>00500 <span class="keywordtype">int</span>
<a name="l00501"></a>00501 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#af7adb54d2ed6bcfd5b722428bfcfb6d6">seaf_repo_manager_update_folder_perm_timestamp</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr,
<a name="l00502"></a>00502                                                 <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id,
<a name="l00503"></a>00503                                                 gint64 timestamp);
<a name="l00504"></a>00504 
<a name="l00505"></a>00505 gint64
<a name="l00506"></a>00506 <a class="code" href="daemon_2Backups_2repo-mgr_8c.html#a7320afc04f67e0cb3dcc20389479c234">seaf_repo_manager_get_folder_perm_timestamp</a> (<a class="code" href="struct__SeafRepoManager.html">SeafRepoManager</a> *mgr,
<a name="l00507"></a>00507                                              <span class="keyword">const</span> <span class="keywordtype">char</span> *repo_id);
<a name="l00508"></a>00508 
<a name="l00509"></a>00509 <span class="preprocessor">#endif</span>
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Wed Aug 19 2015 03:59:42 for My Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
