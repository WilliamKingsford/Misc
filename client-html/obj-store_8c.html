<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>My Project: seafile-4.1.2/common/obj-store.c File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">My Project
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">seafile-4.1.2/common/obj-store.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="seafile-4_81_82_2common_2common_8h_source.html">common.h</a>&quot;</code><br/>
<code>#include &lt;<a class="el" href="cevent_8h_source.html">ccnet/cevent.h</a>&gt;</code><br/>
<code>#include &quot;seafile-session.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="obj-backend_8h_source.html">obj-backend.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="obj-store_8h_source.html">obj-store.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for obj-store.c:</div>
<div class="dyncontent">
<div class="center"><img src="obj-store_8c__incl.png" border="0" usemap="#seafile-4_81_82_2common_2obj-store_8c" alt=""/></div>
<map name="seafile-4_81_82_2common_2obj-store_8c" id="seafile-4_81_82_2common_2obj-store_8c">
<area shape="rect" id="node3" href="seafile-4_81_82_2common_2common_8h.html" title="common.h" alt="" coords="503,160,585,189"/><area shape="rect" id="node27" href="cevent_8h.html" title="ccnet/cevent.h" alt="" coords="1037,83,1144,112"/><area shape="rect" id="node36" href="obj-backend_8h.html" title="obj&#45;backend.h" alt="" coords="895,83,996,112"/><area shape="rect" id="node39" href="obj-store_8h.html" title="obj&#45;store.h" alt="" coords="825,160,908,189"/></map>
</div>
</div>
<p><a href="obj-store_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structAsyncTask.html">AsyncTask</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structOSCallbackStruct.html">OSCallbackStruct</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structSeafObjStore.html">SeafObjStore</a></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#ac46b6c83f9dd53a711de7fd38d97e86a">MAX_READER_THREADS</a>&#160;&#160;&#160;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#ab88daa14a5ece70de21f826ccbc94edf">MAX_WRITER_THREADS</a>&#160;&#160;&#160;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#aa7bd50aa76fa3da6200c041f4636e73f">MAX_STAT_THREADS</a>&#160;&#160;&#160;2</td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structAsyncTask.html">AsyncTask</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#ac90535336a1d23adb5e8740078f05e08">AsyncTask</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structOSCallbackStruct.html">OSCallbackStruct</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#a3ec51ed2f3e1155c24d3695480b23d7f">OSCallbackStruct</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#ad4d3c7e0db63317207022cfc6ca120f7">SeafObjStore</a></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structObjBackend.html">ObjBackend</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#acf75816d5ce4f49a6fbb7dfefd310157">obj_backend_fs_new</a> (const char *seaf_dir, const char *obj_type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#ad871019d105d6cada26d2d7d5876a31d">seaf_obj_store_new</a> (<a class="el" href="daemon_2seafile-session_8h.html#a3412e7ea22f43083cdc07acffa80f859">SeafileSession</a> *<a class="el" href="server_2seafile-session_8h.html#ae66636d1834d105bd51d89ff01acfe15">seaf</a>, const char *obj_type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#a2a3f1a84562cb4856e94b556888e3617">seaf_obj_store_init</a> (<a class="el" href="structSeafObjStore.html">SeafObjStore</a> *obj_store, gboolean enable_async, <a class="el" href="structCEventManager.html">CEventManager</a> *ev_mgr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#a6e93a0214f9cb8a7fc837a2bc3a3c529">seaf_obj_store_read_obj</a> (struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *obj_store, const char *repo_id, int <a class="el" href="block-tx-utils_8h.html#a1abe2c64ac9f8bc05bbb1719cad360f3">version</a>, const char *<a class="el" href="http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>, void **data, int *len)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#a673d1262bbb4caf66816c89bde13b429">seaf_obj_store_write_obj</a> (struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *obj_store, const char *repo_id, int <a class="el" href="block-tx-utils_8h.html#a1abe2c64ac9f8bc05bbb1719cad360f3">version</a>, const char *<a class="el" href="http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>, void *data, int len, gboolean need_sync)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gboolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#abebb46e47ff4c76a309686613bd17ec1">seaf_obj_store_obj_exists</a> (struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *obj_store, const char *repo_id, int <a class="el" href="block-tx-utils_8h.html#a1abe2c64ac9f8bc05bbb1719cad360f3">version</a>, const char *<a class="el" href="http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#a6a52cc8396499b225486967b6a25719d">seaf_obj_store_delete_obj</a> (struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *obj_store, const char *repo_id, int <a class="el" href="block-tx-utils_8h.html#a1abe2c64ac9f8bc05bbb1719cad360f3">version</a>, const char *<a class="el" href="http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#af93108b4e51fb58bf0c1c853277c0c5d">seaf_obj_store_foreach_obj</a> (struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *obj_store, const char *repo_id, int <a class="el" href="block-tx-utils_8h.html#a1abe2c64ac9f8bc05bbb1719cad360f3">version</a>, <a class="el" href="obj-store_8h.html#a7b4f7b323444742cbe9a7e2e96e3f8ba">SeafObjFunc</a> process, void *user_data)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#aa3ca2d1702dfb62a2a27834b8cbcc676">seaf_obj_store_copy_obj</a> (struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *obj_store, const char *src_repo_id, int src_version, const char *dst_repo_id, int dst_version, const char *<a class="el" href="http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">guint32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#a09823d4a0c3913096cf776fa88fe638f">seaf_obj_store_register_async_read</a> (struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *obj_store, const char *repo_id, int <a class="el" href="block-tx-utils_8h.html#a1abe2c64ac9f8bc05bbb1719cad360f3">version</a>, <a class="el" href="obj-store_8h.html#aa94298cc70e0f6ad59d4bc31e29441ca">OSAsyncCallback</a> callback, void *cb_data)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#a247f0d971299f7e837abcdb2de27b18c">seaf_obj_store_unregister_async_read</a> (struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *obj_store, guint32 reader_id)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#a9c4f7f623c811b44d9682361e8016016">seaf_obj_store_async_read</a> (struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *obj_store, guint32 reader_id, const char *<a class="el" href="http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">guint32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#aefe8e7c44c240a98928c610191d051b8">seaf_obj_store_register_async_stat</a> (struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *obj_store, const char *repo_id, int <a class="el" href="block-tx-utils_8h.html#a1abe2c64ac9f8bc05bbb1719cad360f3">version</a>, <a class="el" href="obj-store_8h.html#aa94298cc70e0f6ad59d4bc31e29441ca">OSAsyncCallback</a> callback, void *cb_data)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#a4633a0fe044d9831be5abfeb5c09a38f">seaf_obj_store_unregister_async_stat</a> (struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *obj_store, guint32 stat_id)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#ad906469c9e1db2ad6add99e0fcc9ce62">seaf_obj_store_async_stat</a> (struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *obj_store, guint32 stat_id, const char *<a class="el" href="http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">guint32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#a20498bde091546677a081d7590fefacb">seaf_obj_store_register_async_write</a> (struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *obj_store, const char *repo_id, int <a class="el" href="block-tx-utils_8h.html#a1abe2c64ac9f8bc05bbb1719cad360f3">version</a>, <a class="el" href="obj-store_8h.html#aa94298cc70e0f6ad59d4bc31e29441ca">OSAsyncCallback</a> callback, void *cb_data)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#a2b7b66e759297fae9d029eb86c2595ac">seaf_obj_store_unregister_async_write</a> (struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *obj_store, guint32 writer_id)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="obj-store_8c.html#a61a8a85267a968610f944c46ee5045a2">seaf_obj_store_async_write</a> (struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *obj_store, guint32 writer_id, const char *<a class="el" href="http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>, const void *obj_data, int data_len, gboolean need_sync)</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ac46b6c83f9dd53a711de7fd38d97e86a"></a><!-- doxytag: member="obj&#45;store.c::MAX_READER_THREADS" ref="ac46b6c83f9dd53a711de7fd38d97e86a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="obj-store_8c.html#ac46b6c83f9dd53a711de7fd38d97e86a">MAX_READER_THREADS</a>&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00009">9</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa7bd50aa76fa3da6200c041f4636e73f"></a><!-- doxytag: member="obj&#45;store.c::MAX_STAT_THREADS" ref="aa7bd50aa76fa3da6200c041f4636e73f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="obj-store_8c.html#aa7bd50aa76fa3da6200c041f4636e73f">MAX_STAT_THREADS</a>&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00011">11</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab88daa14a5ece70de21f826ccbc94edf"></a><!-- doxytag: member="obj&#45;store.c::MAX_WRITER_THREADS" ref="ab88daa14a5ece70de21f826ccbc94edf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="obj-store_8c.html#ab88daa14a5ece70de21f826ccbc94edf">MAX_WRITER_THREADS</a>&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00010">10</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="ac90535336a1d23adb5e8740078f05e08"></a><!-- doxytag: member="obj&#45;store.c::AsyncTask" ref="ac90535336a1d23adb5e8740078f05e08" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structAsyncTask.html">AsyncTask</a>  <a class="el" href="structAsyncTask.html">AsyncTask</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a3ec51ed2f3e1155c24d3695480b23d7f"></a><!-- doxytag: member="obj&#45;store.c::OSCallbackStruct" ref="a3ec51ed2f3e1155c24d3695480b23d7f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structOSCallbackStruct.html">OSCallbackStruct</a>  <a class="el" href="structOSCallbackStruct.html">OSCallbackStruct</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad4d3c7e0db63317207022cfc6ca120f7"></a><!-- doxytag: member="obj&#45;store.c::SeafObjStore" ref="ad4d3c7e0db63317207022cfc6ca120f7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> <a class="el" href="structSeafObjStore.html">SeafObjStore</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00052">52</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="acf75816d5ce4f49a6fbb7dfefd310157"></a><!-- doxytag: member="obj&#45;store.c::obj_backend_fs_new" ref="acf75816d5ce4f49a6fbb7dfefd310157" args="(const char *seaf_dir, const char *obj_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structObjBackend.html">ObjBackend</a>* <a class="el" href="obj-store_8c.html#acf75816d5ce4f49a6fbb7dfefd310157">obj_backend_fs_new</a> </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>seaf_dir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>obj_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-backend-fs_8c_source.html#l00456">456</a> of file <a class="el" href="obj-backend-fs_8c_source.html">obj-backend-fs.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structObjBackend.html">ObjBackend</a> *bend;
    <a class="code" href="structFsPriv.html">FsPriv</a> *<a class="code" href="monitor-tool_8c.html#a694b59386a408403dbb70994ed5beaa1">priv</a>;

    bend = g_new0(<a class="code" href="structObjBackend.html">ObjBackend</a>, 1);
    priv = g_new0(<a class="code" href="structFsPriv.html">FsPriv</a>, 1);
    bend-&gt;<a class="code" href="structObjBackend.html#a5ea5b5a6bb68383c7521c9111c5d5254">priv</a> = <a class="code" href="monitor-tool_8c.html#a694b59386a408403dbb70994ed5beaa1">priv</a>;

    priv-&gt;<a class="code" href="structFsPriv.html#a4c03d2c57d555ed895a920a9d7a43b64">v0_obj_dir</a> = g_build_filename (seaf_dir, obj_type, NULL);
    priv-&gt;<a class="code" href="structFsPriv.html#aa6ee470ce28203c07fe4bf9ddaed8963">v0_dir_len</a> = strlen(priv-&gt;<a class="code" href="structFsPriv.html#a4c03d2c57d555ed895a920a9d7a43b64">v0_obj_dir</a>);

    priv-&gt;<a class="code" href="structFsPriv.html#a3ca88d28ca3d60ca2de06cef2dfd3600">obj_dir</a> = g_build_filename (seaf_dir, <span class="stringliteral">&quot;storage&quot;</span>, obj_type, NULL);
    priv-&gt;<a class="code" href="structFsPriv.html#a4ddedd669747112c48745c391ce41db6">dir_len</a> = strlen (priv-&gt;<a class="code" href="structFsPriv.html#a3ca88d28ca3d60ca2de06cef2dfd3600">obj_dir</a>);

    <span class="keywordflow">if</span> (g_mkdir_with_parents (priv-&gt;<a class="code" href="structFsPriv.html#a4c03d2c57d555ed895a920a9d7a43b64">v0_obj_dir</a>, 0777) &lt; 0) {
        seaf_warning (<span class="stringliteral">&quot;[Obj Backend] Objects dir %s does not exist and&quot;</span>
                   <span class="stringliteral">&quot; is unable to create\n&quot;</span>, priv-&gt;<a class="code" href="structFsPriv.html#a4c03d2c57d555ed895a920a9d7a43b64">v0_obj_dir</a>);
        <span class="keywordflow">goto</span> onerror;
    }

    <span class="keywordflow">if</span> (g_mkdir_with_parents (priv-&gt;<a class="code" href="structFsPriv.html#a3ca88d28ca3d60ca2de06cef2dfd3600">obj_dir</a>, 0777) &lt; 0) {
        seaf_warning (<span class="stringliteral">&quot;[Obj Backend] Objects dir %s does not exist and&quot;</span>
                   <span class="stringliteral">&quot; is unable to create\n&quot;</span>, priv-&gt;<a class="code" href="structFsPriv.html#a3ca88d28ca3d60ca2de06cef2dfd3600">obj_dir</a>);
        <span class="keywordflow">goto</span> onerror;
    }

    bend-&gt;<a class="code" href="structObjBackend.html#ae1368dcc58999fa9396b49c05063c8ba">read</a> = obj_backend_fs_read;
    bend-&gt;<a class="code" href="structObjBackend.html#aa3722d257b0a127dd5ff23e07ce5c2f6">write</a> = obj_backend_fs_write;
    bend-&gt;<a class="code" href="structObjBackend.html#a401dfe722f768ce458d56fc1a8c0ef18">exists</a> = obj_backend_fs_exists;
    bend-&gt;<a class="code" href="structObjBackend.html#ae24f41bcfa4937240e26d1caee6c3deb">delete</a> = obj_backend_fs_delete;
    bend-&gt;<a class="code" href="structObjBackend.html#ac359224ebc26f5919432dcd57344814c">foreach_obj</a> = obj_backend_fs_foreach_obj;
    bend-&gt;<a class="code" href="structObjBackend.html#a6811505f557129104a5656224a5a6d1b">copy</a> = obj_backend_fs_copy;

    <span class="keywordflow">return</span> bend;

onerror:
    g_free (priv-&gt;<a class="code" href="structFsPriv.html#a4c03d2c57d555ed895a920a9d7a43b64">v0_obj_dir</a>);
    g_free (priv-&gt;<a class="code" href="structFsPriv.html#a3ca88d28ca3d60ca2de06cef2dfd3600">obj_dir</a>);
    g_free (priv);
    g_free (bend);

    <span class="keywordflow">return</span> NULL;
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="obj-store_8c_acf75816d5ce4f49a6fbb7dfefd310157_icgraph.png" border="0" usemap="#obj-store_8c_acf75816d5ce4f49a6fbb7dfefd310157_icgraph" alt=""/></div>
<map name="obj-store_8c_acf75816d5ce4f49a6fbb7dfefd310157_icgraph" id="obj-store_8c_acf75816d5ce4f49a6fbb7dfefd310157_icgraph">
<area shape="rect" id="node3" href="obj-store_8h.html#aa459d704de605d925c2ad9e0b09cd1fd" title="seaf_obj_store_new" alt="" coords="197,5,336,35"/><area shape="rect" id="node5" href="commit-mgr_8h.html#adf25d93994a29514d42a3793ee88cd0a" title="seaf_commit_manager_new" alt="" coords="385,5,569,35"/><area shape="rect" id="node7" href="daemon_2seafile-session_8h.html#a3eea8fbb412edb5ff72027285edb7c72" title="seafile_session_new" alt="" coords="620,5,761,35"/><area shape="rect" id="node9" href="seaf-daemon_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="811,5,861,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9c4f7f623c811b44d9682361e8016016"></a><!-- doxytag: member="obj&#45;store.c::seaf_obj_store_async_read" ref="a9c4f7f623c811b44d9682361e8016016" args="(struct SeafObjStore *obj_store, guint32 reader_id, const char *obj_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="obj-store_8h.html#a9c4f7f623c811b44d9682361e8016016">seaf_obj_store_async_read</a> </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *&#160;</td>
          <td class="paramname"><em>obj_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">guint32&#160;</td>
          <td class="paramname"><em>reader_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>obj_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00403">403</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structAsyncTask.html">AsyncTask</a> *task = g_new0 (<a class="code" href="structAsyncTask.html">AsyncTask</a>, 1);
    GError *error = NULL;

    task-&gt;<a class="code" href="structAsyncTask.html#a446ae47a62111aebdc035a82b7c0430c">rw_id</a> = reader_id;
    memcpy (task-&gt;<a class="code" href="structAsyncTask.html#a8df71dbca14bcbd4e42fc252755baece">obj_id</a>, <a class="code" href="Backups_2http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>, 41);

    g_thread_pool_push (obj_store-&gt;<a class="code" href="structSeafObjStore.html#a37a257a1171599cce7b90fda61991376">read_tpool</a>, task, &amp;error);
    <span class="keywordflow">if</span> (error) {
        g_warning (<span class="stringliteral">&quot;Failed to start aysnc read of %s.\n&quot;</span>, <a class="code" href="Backups_2http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>);
        <span class="keywordflow">return</span> -1;
    }

    <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad906469c9e1db2ad6add99e0fcc9ce62"></a><!-- doxytag: member="obj&#45;store.c::seaf_obj_store_async_stat" ref="ad906469c9e1db2ad6add99e0fcc9ce62" args="(struct SeafObjStore *obj_store, guint32 stat_id, const char *obj_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="obj-store_8h.html#ad906469c9e1db2ad6add99e0fcc9ce62">seaf_obj_store_async_stat</a> </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *&#160;</td>
          <td class="paramname"><em>obj_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">guint32&#160;</td>
          <td class="paramname"><em>stat_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>obj_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00450">450</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structAsyncTask.html">AsyncTask</a> *task = g_new0 (<a class="code" href="structAsyncTask.html">AsyncTask</a>, 1);
    GError *error = NULL;

    task-&gt;<a class="code" href="structAsyncTask.html#a446ae47a62111aebdc035a82b7c0430c">rw_id</a> = stat_id;
    memcpy (task-&gt;<a class="code" href="structAsyncTask.html#a8df71dbca14bcbd4e42fc252755baece">obj_id</a>, <a class="code" href="Backups_2http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>, 41);

    g_thread_pool_push (obj_store-&gt;<a class="code" href="structSeafObjStore.html#a9bfe7fc76188aa27acabb3ba0f8d7943">stat_tpool</a>, task, &amp;error);
    <span class="keywordflow">if</span> (error) {
        g_warning (<span class="stringliteral">&quot;Failed to start aysnc stat of %s.\n&quot;</span>, <a class="code" href="Backups_2http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>);
        <span class="keywordflow">return</span> -1;
    }

    <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a61a8a85267a968610f944c46ee5045a2"></a><!-- doxytag: member="obj&#45;store.c::seaf_obj_store_async_write" ref="a61a8a85267a968610f944c46ee5045a2" args="(struct SeafObjStore *obj_store, guint32 writer_id, const char *obj_id, const void *obj_data, int data_len, gboolean need_sync)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="obj-store_8h.html#a61a8a85267a968610f944c46ee5045a2">seaf_obj_store_async_write</a> </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *&#160;</td>
          <td class="paramname"><em>obj_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">guint32&#160;</td>
          <td class="paramname"><em>writer_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>obj_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>obj_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>data_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>need_sync</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00497">497</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structAsyncTask.html">AsyncTask</a> *task = g_new0 (<a class="code" href="structAsyncTask.html">AsyncTask</a>, 1);
    GError *error = NULL;

    task-&gt;<a class="code" href="structAsyncTask.html#a446ae47a62111aebdc035a82b7c0430c">rw_id</a> = writer_id;
    memcpy (task-&gt;<a class="code" href="structAsyncTask.html#a8df71dbca14bcbd4e42fc252755baece">obj_id</a>, <a class="code" href="Backups_2http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>, 41);
    task-&gt;<a class="code" href="structAsyncTask.html#acaa27a27350f5b6bee7cca32fa214ccc">data</a> = g_memdup (obj_data, data_len);
    task-&gt;<a class="code" href="structAsyncTask.html#a290407fa5580327ff2f1efb2a75dbc49">len</a> = data_len;
    task-&gt;<a class="code" href="structAsyncTask.html#a2e9376199abdd10eece48d57b2d9a888">need_sync</a> = need_sync;

    g_thread_pool_push (obj_store-&gt;<a class="code" href="structSeafObjStore.html#aec5d81ca1f9f7eea7aeef5553792adfa">write_tpool</a>, task, &amp;error);
    <span class="keywordflow">if</span> (error) {
        g_warning (<span class="stringliteral">&quot;Failed to start aysnc write of %s.\n&quot;</span>, <a class="code" href="Backups_2http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>);
        <span class="keywordflow">return</span> -1;
    }

    <span class="keywordflow">return</span> 0;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aa3ca2d1702dfb62a2a27834b8cbcc676"></a><!-- doxytag: member="obj&#45;store.c::seaf_obj_store_copy_obj" ref="aa3ca2d1702dfb62a2a27834b8cbcc676" args="(struct SeafObjStore *obj_store, const char *src_repo_id, int src_version, const char *dst_repo_id, int dst_version, const char *obj_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="obj-store_8h.html#ab2f7b2b9aed384c4b3cc0d6f55fabee2">seaf_obj_store_copy_obj</a> </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *&#160;</td>
          <td class="paramname"><em>obj_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>src_repo_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>src_version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>dst_repo_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dst_version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>obj_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00223">223</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structObjBackend.html">ObjBackend</a> *bend = obj_store-&gt;<a class="code" href="structSeafObjStore.html#aa6d49025e2d6adcd47d3b423bb63c06b">bend</a>;

    <span class="keywordflow">if</span> (strcmp (<a class="code" href="Backups_2http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>, <a class="code" href="seafile-4_81_82_2common_2common_8h.html#aaa0130adfcd2ec28ea4cf85337ace2da">EMPTY_SHA1</a>) == 0)
        <span class="keywordflow">return</span> 0;

    <span class="keywordflow">return</span> bend-&gt;<a class="code" href="structObjBackend.html#a6811505f557129104a5656224a5a6d1b">copy</a> (bend, src_repo_id, src_version, dst_repo_id, dst_version, <a class="code" href="Backups_2http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6a52cc8396499b225486967b6a25719d"></a><!-- doxytag: member="obj&#45;store.c::seaf_obj_store_delete_obj" ref="a6a52cc8396499b225486967b6a25719d" args="(struct SeafObjStore *obj_store, const char *repo_id, int version, const char *obj_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="obj-store_8h.html#a6a52cc8396499b225486967b6a25719d">seaf_obj_store_delete_obj</a> </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *&#160;</td>
          <td class="paramname"><em>obj_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>repo_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>obj_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00200">200</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structObjBackend.html">ObjBackend</a> *bend = obj_store-&gt;<a class="code" href="structSeafObjStore.html#aa6d49025e2d6adcd47d3b423bb63c06b">bend</a>;

    <span class="keywordflow">return</span> bend-&gt;<a class="code" href="structObjBackend.html#ae24f41bcfa4937240e26d1caee6c3deb">delete</a> (bend, repo_id, <a class="code" href="block-tx-utils_8h.html#a1abe2c64ac9f8bc05bbb1719cad360f3">version</a>, <a class="code" href="Backups_2http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>);
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="obj-store_8c_a6a52cc8396499b225486967b6a25719d_icgraph.png" border="0" usemap="#obj-store_8c_a6a52cc8396499b225486967b6a25719d_icgraph" alt=""/></div>
<map name="obj-store_8c_a6a52cc8396499b225486967b6a25719d_icgraph" id="obj-store_8c_a6a52cc8396499b225486967b6a25719d_icgraph">
<area shape="rect" id="node3" href="fs-mgr_8h.html#ac378976c82415b33c8fbdfb42d5ca83d" title="seaf_fs_manager_delete_object" alt="" coords="228,5,433,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af93108b4e51fb58bf0c1c853277c0c5d"></a><!-- doxytag: member="obj&#45;store.c::seaf_obj_store_foreach_obj" ref="af93108b4e51fb58bf0c1c853277c0c5d" args="(struct SeafObjStore *obj_store, const char *repo_id, int version, SeafObjFunc process, void *user_data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="obj-store_8h.html#af93108b4e51fb58bf0c1c853277c0c5d">seaf_obj_store_foreach_obj</a> </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *&#160;</td>
          <td class="paramname"><em>obj_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>repo_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="obj-store_8h.html#a7b4f7b323444742cbe9a7e2e96e3f8ba">SeafObjFunc</a>&#160;</td>
          <td class="paramname"><em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00211">211</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structObjBackend.html">ObjBackend</a> *bend = obj_store-&gt;<a class="code" href="structSeafObjStore.html#aa6d49025e2d6adcd47d3b423bb63c06b">bend</a>;

    <span class="keywordflow">return</span> bend-&gt;<a class="code" href="structObjBackend.html#ac359224ebc26f5919432dcd57344814c">foreach_obj</a> (bend, repo_id, <a class="code" href="block-tx-utils_8h.html#a1abe2c64ac9f8bc05bbb1719cad360f3">version</a>, process, user_data);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2a3f1a84562cb4856e94b556888e3617"></a><!-- doxytag: member="obj&#45;store.c::seaf_obj_store_init" ref="a2a3f1a84562cb4856e94b556888e3617" args="(SeafObjStore *obj_store, gboolean enable_async, CEventManager *ev_mgr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="obj-store_8h.html#afddb004cd06b1f0788e080271fefc364">seaf_obj_store_init</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSeafObjStore.html">SeafObjStore</a> *&#160;</td>
          <td class="paramname"><em>obj_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>enable_async</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structCEventManager.html">CEventManager</a> *&#160;</td>
          <td class="paramname"><em>ev_mgr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00151">151</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (enable_async &amp;&amp; async_init (obj_store, ev_mgr) &lt; 0)
        <span class="keywordflow">return</span> -1;

    <span class="keywordflow">return</span> 0;
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="obj-store_8c_a2a3f1a84562cb4856e94b556888e3617_icgraph.png" border="0" usemap="#obj-store_8c_a2a3f1a84562cb4856e94b556888e3617_icgraph" alt=""/></div>
<map name="obj-store_8c_a2a3f1a84562cb4856e94b556888e3617_icgraph" id="obj-store_8c_a2a3f1a84562cb4856e94b556888e3617_icgraph">
<area shape="rect" id="node3" href="commit-mgr_8h.html#ad6fdc75fe20bb5941a19a436742cb696" title="seaf_commit_manager_init" alt="" coords="184,17,363,47"/><area shape="rect" id="node14" href="fs-mgr_8h.html#a91dd774f96fb5cc505f423913ea730fe" title="seaf_fs_manager_init" alt="" coords="200,71,347,100"/><area shape="rect" id="node5" href="daemon_2seafile-session_8h.html#abe136340477380edec6a5deba0ff8e1a" title="seafile_session_prepare" alt="" coords="411,5,573,35"/><area shape="rect" id="node9" href="server_2seafile-session_8h.html#a5dbc4cb373997a756130cfe875b86ce6" title="seafile_session_init" alt="" coords="424,83,560,112"/><area shape="rect" id="node7" href="seaf-daemon_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="621,5,672,35"/><area shape="rect" id="node12" href="seaf-fuse_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="main" alt="" coords="621,83,672,112"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad871019d105d6cada26d2d7d5876a31d"></a><!-- doxytag: member="obj&#45;store.c::seaf_obj_store_new" ref="ad871019d105d6cada26d2d7d5876a31d" args="(SeafileSession *seaf, const char *obj_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a>* <a class="el" href="obj-store_8h.html#aa459d704de605d925c2ad9e0b09cd1fd">seaf_obj_store_new</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="daemon_2seafile-session_8h.html#a3412e7ea22f43083cdc07acffa80f859">SeafileSession</a> *&#160;</td>
          <td class="paramname"><em>seaf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>obj_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00072">72</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structSeafObjStore.html">SeafObjStore</a> *store = g_new0 (<a class="code" href="structSeafObjStore.html">SeafObjStore</a>, 1);

    <span class="keywordflow">if</span> (!store)
        <span class="keywordflow">return</span> NULL;

    store-&gt;<a class="code" href="structSeafObjStore.html#aa6d49025e2d6adcd47d3b423bb63c06b">bend</a> = <a class="code" href="obj-backend-fs_8c.html#acf75816d5ce4f49a6fbb7dfefd310157">obj_backend_fs_new</a> (seaf-&gt;<a class="code" href="struct__SeafileSession.html#ae4df188e5674e3e4b405f14d0ee1bf9f">seaf_dir</a>, obj_type);
    <span class="keywordflow">if</span> (!store-&gt;<a class="code" href="structSeafObjStore.html#aa6d49025e2d6adcd47d3b423bb63c06b">bend</a>) {
        g_warning (<span class="stringliteral">&quot;[Object store] Failed to load backend.\n&quot;</span>);
        g_free (store);
        <span class="keywordflow">return</span> NULL;
    }

    <span class="keywordflow">return</span> store;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="obj-store_8c_ad871019d105d6cada26d2d7d5876a31d_cgraph.png" border="0" usemap="#obj-store_8c_ad871019d105d6cada26d2d7d5876a31d_cgraph" alt=""/></div>
<map name="obj-store_8c_ad871019d105d6cada26d2d7d5876a31d_cgraph" id="obj-store_8c_ad871019d105d6cada26d2d7d5876a31d_cgraph">
<area shape="rect" id="node3" href="obj-backend-fs_8c.html#acf75816d5ce4f49a6fbb7dfefd310157" title="obj_backend_fs_new" alt="" coords="192,5,336,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="obj-store_8c_ad871019d105d6cada26d2d7d5876a31d_icgraph.png" border="0" usemap="#obj-store_8c_ad871019d105d6cada26d2d7d5876a31d_icgraph" alt=""/></div>
<map name="obj-store_8c_ad871019d105d6cada26d2d7d5876a31d_icgraph" id="obj-store_8c_ad871019d105d6cada26d2d7d5876a31d_icgraph">
<area shape="rect" id="node3" href="commit-mgr_8h.html#adf25d93994a29514d42a3793ee88cd0a" title="seaf_commit_manager_new" alt="" coords="193,5,377,35"/><area shape="rect" id="node5" href="daemon_2seafile-session_8h.html#a3eea8fbb412edb5ff72027285edb7c72" title="seafile_session_new" alt="" coords="428,5,569,35"/><area shape="rect" id="node7" href="seaf-daemon_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="619,5,669,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abebb46e47ff4c76a309686613bd17ec1"></a><!-- doxytag: member="obj&#45;store.c::seaf_obj_store_obj_exists" ref="abebb46e47ff4c76a309686613bd17ec1" args="(struct SeafObjStore *obj_store, const char *repo_id, int version, const char *obj_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean <a class="el" href="obj-store_8h.html#abebb46e47ff4c76a309686613bd17ec1">seaf_obj_store_obj_exists</a> </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *&#160;</td>
          <td class="paramname"><em>obj_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>repo_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>obj_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00189">189</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structObjBackend.html">ObjBackend</a> *bend = obj_store-&gt;<a class="code" href="structSeafObjStore.html#aa6d49025e2d6adcd47d3b423bb63c06b">bend</a>;

    <span class="keywordflow">return</span> bend-&gt;<a class="code" href="structObjBackend.html#a401dfe722f768ce458d56fc1a8c0ef18">exists</a> (bend, repo_id, <a class="code" href="block-tx-utils_8h.html#a1abe2c64ac9f8bc05bbb1719cad360f3">version</a>, <a class="code" href="Backups_2http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>);
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="obj-store_8c_abebb46e47ff4c76a309686613bd17ec1_icgraph.png" border="0" usemap="#obj-store_8c_abebb46e47ff4c76a309686613bd17ec1_icgraph" alt=""/></div>
<map name="obj-store_8c_abebb46e47ff4c76a309686613bd17ec1_icgraph" id="obj-store_8c_abebb46e47ff4c76a309686613bd17ec1_icgraph">
<area shape="rect" id="node3" href="commit-mgr_8h.html#aa63ceac8efb25da43ced2cfccf460ac5" title="seaf_commit_manager_commit_exists" alt="" coords="228,5,473,35"/><area shape="rect" id="node5" href="fs-mgr_8h.html#a9262b8849eabb4d72009ca1feb396c20" title="seaf_fs_manager_object_exists" alt="" coords="248,59,453,88"/><area shape="rect" id="node7" href="vc-utils_8h.html#a40a8e3a1dc14697c58656246b3fa9ca0" title="commit_trees_cb" alt="" coords="523,59,645,88"/><area shape="rect" id="node9" href="daemon_2repo-mgr_8h.html#a77e557bb1fedd648a109ab5d9bff5ef4" title="seaf_repo_index_worktree_files" alt="" coords="693,5,899,35"/><area shape="rect" id="node11" href="daemon_2repo-mgr_8h.html#ab6d5318b3a1cc6f86733ff71b16815a8" title="seaf_repo_index_commit" alt="" coords="713,59,879,88"/><area shape="rect" id="node13" href="merge-recursive_8h.html#a5ece2c4c0b1acc045660424d1fb74f36" title="write_tree_from_memory" alt="" coords="713,112,879,141"/><area shape="rect" id="node15" href="merge-recursive_8h.html#ac5c545b083f8e950f4e13cb31b4a74d1" title="merge_recursive" alt="" coords="948,112,1065,141"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6e93a0214f9cb8a7fc837a2bc3a3c529"></a><!-- doxytag: member="obj&#45;store.c::seaf_obj_store_read_obj" ref="a6e93a0214f9cb8a7fc837a2bc3a3c529" args="(struct SeafObjStore *obj_store, const char *repo_id, int version, const char *obj_id, void **data, int *len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="obj-store_8h.html#a6e93a0214f9cb8a7fc837a2bc3a3c529">seaf_obj_store_read_obj</a> </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *&#160;</td>
          <td class="paramname"><em>obj_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>repo_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>obj_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00162">162</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structObjBackend.html">ObjBackend</a> *bend = obj_store-&gt;<a class="code" href="structSeafObjStore.html#aa6d49025e2d6adcd47d3b423bb63c06b">bend</a>;

    <span class="keywordflow">return</span> bend-&gt;<a class="code" href="structObjBackend.html#ae1368dcc58999fa9396b49c05063c8ba">read</a> (bend, repo_id, <a class="code" href="block-tx-utils_8h.html#a1abe2c64ac9f8bc05bbb1719cad360f3">version</a>, <a class="code" href="Backups_2http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>, data, len);
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="obj-store_8c_a6e93a0214f9cb8a7fc837a2bc3a3c529_icgraph.png" border="0" usemap="#obj-store_8c_a6e93a0214f9cb8a7fc837a2bc3a3c529_icgraph" alt=""/></div>
<map name="obj-store_8c_a6e93a0214f9cb8a7fc837a2bc3a3c529_icgraph" id="obj-store_8c_a6e93a0214f9cb8a7fc837a2bc3a3c529_icgraph">
<area shape="rect" id="node3" href="fs-mgr_8h.html#a029c16e2ecdf6eafd96edb2ee4e6beac" title="seaf_fs_manager_get_seafile" alt="" coords="224,139,416,168"/><area shape="rect" id="node23" href="fs-mgr_8h.html#a08103ffc3a5cd19b70167404c39ce3e4" title="seaf_fs_manager_get_seafdir" alt="" coords="224,431,416,460"/><area shape="rect" id="node93" href="fs-mgr_8h.html#aa0c330524a615b7550fc5ffe7a4da7f4" title="seaf_fs_manager_verify_seafdir" alt="" coords="217,484,423,513"/><area shape="rect" id="node95" href="fs-mgr_8h.html#af6125641a9cc5a746f9716c2feadcfa8" title="seaf_fs_manager_verify_seafile" alt="" coords="217,537,423,567"/><area shape="rect" id="node97" href="fs-mgr_8h.html#a70406a91027ed3add3d9026d8dad8a0c" title="seaf_fs_manager_verify_object" alt="" coords="219,591,421,620"/><area shape="rect" id="node5" href="fs-mgr_8h.html#a36b814252ae47bd595a9282266ea1b56" title="seaf_fs_manager_checkout_file" alt="" coords="513,112,719,141"/><area shape="rect" id="node11" href="fs-mgr_8h.html#a0927ab6809d59562a0782cb80e410575" title="seaf_fs_manager_get_file_size" alt="" coords="515,5,717,35"/><area shape="rect" id="node13" href="http-tx-mgr_8h.html#a3cdcb1e4f4996dabc1adb7ae742ddfb4" title="http_tx_task_download_file_blocks" alt="" coords="504,165,728,195"/><area shape="rect" id="node16" href="transfer-mgr_8h.html#a760b69b5aa68dcb74c3020f091d1fc6c" title="seaf_transfer_manager_download_file_blocks" alt="" coords="473,59,759,88"/><area shape="rect" id="node19" href="vc-utils_8h.html#a7564d102761a05b137c2b06fa5e1f004" title="fill_seafile_blocks" alt="" coords="553,219,679,248"/><area shape="rect" id="node7" href="daemon_2Backups_2repo-mgr_8c.html#a450e5bcc50da4c40b7ba2bde33a22a84" title="checkout_file" alt="" coords="900,112,999,141"/><area shape="rect" id="node9" href="daemon_2repo-mgr_8h.html#a836678a67f23541ed108f922f0848e52" title="seaf_repo_fetch_and_checkout" alt="" coords="1169,219,1372,248"/><area shape="rect" id="node21" href="vc-utils_8h.html#a679a356f1eff6a4f953fe26f3f841f93" title="collect_new_blocks_from_index" alt="" coords="847,165,1052,195"/><area shape="rect" id="node25" href="diff-simple_8h.html#aad681f9b9d7dbc7586efaa4cd0b254e6" title="diff_trees" alt="" coords="579,379,653,408"/><area shape="rect" id="node39" href="fs-mgr_8h.html#a451e6d84cb6d10454d1f9b2b3d0205c5" title="seaf_fs_manager_get_seafdir_sorted" alt="" coords="499,483,733,512"/><area shape="rect" id="node45" href="status_8h.html#a5aaef0b3a73d20b9f422c9d39f0a2325" title="wt_status_collect_changes_index" alt="" coords="1468,471,1687,500"/><area shape="rect" id="node57" href="fs-mgr_8h.html#a033b8831db7345eec0ff09216b63593d" title="seaf_fs_manager_get_seafdir_by_path" alt="" coords="493,669,739,699"/><area shape="rect" id="node59" href="fs-mgr_8h.html#a60a96b2445ab49d626baac6b16e75fe9" title="seaf_fs_manager_path_to_obj_id" alt="" coords="843,616,1056,645"/><area shape="rect" id="node71" href="fs-mgr_8h.html#ae47ee4428331afd6b9cbf2fa47ecb923" title="seaf_fs_manager_get_dirent_by_path" alt="" coords="831,803,1068,832"/><area shape="rect" id="node88" href="merge-new_8h.html#a1fbfc73ac5c49296574684ef7ac052c7" title="seaf_merge_trees" alt="" coords="553,272,679,301"/><area shape="rect" id="node90" href="merge-recursive_8h.html#ac5c545b083f8e950f4e13cb31b4a74d1" title="merge_recursive" alt="" coords="557,325,675,355"/><area shape="rect" id="node27" href="diff-simple_8h.html#a9e9cbe6847c88fc7bca7035f45a0a50e" title="diff_commits" alt="" coords="901,272,997,301"/><area shape="rect" id="node31" href="diff-simple_8h.html#a76134c9482b81d9ff5455eac2765a656" title="diff_commit_roots" alt="" coords="887,219,1012,248"/><area shape="rect" id="node34" href="diff-simple_8h.html#a8c800ee63c23c5ff78d838974f678e47" title="diff_merge" alt="" coords="908,325,991,355"/><area shape="rect" id="node37" href="diff-simple_8h.html#aaad6d753f728db61f274e7ce8ec70e97" title="diff_merge_roots" alt="" coords="891,379,1008,408"/><area shape="rect" id="node29" href="server_2repo-mgr_8h.html#a168ba33665e04b18089dd5a5d2a18fe3" title="seaf_repo_diff" alt="" coords="1219,299,1323,328"/><area shape="rect" id="node41" href="seaf-tree-walk_8h.html#a7b310abaeb185b8918eb2a9fc843e097" title="fill_tree_descriptor" alt="" coords="885,483,1013,512"/><area shape="rect" id="node43" href="diff-simple_8h.html#a61fa5d287ecd1508b220a422b250d676" title="diff_index" alt="" coords="1232,483,1309,512"/><area shape="rect" id="node49" href="daemon_2repo-mgr_8h.html#a7923c5fb7b957a121f1b2616a8d66745" title="seaf_repo_checkout_commit" alt="" coords="1176,379,1365,408"/><area shape="rect" id="node47" href="daemon_2repo-mgr_8h.html#a461e72948bba5928329e269ad395e293" title="seaf_repo_is_worktree_changed" alt="" coords="1753,471,1961,500"/><area shape="rect" id="node51" href="daemon_2repo-mgr_8h.html#ab553f7b1a5290e99821753acf9e87c86" title="seaf_repo_checkout" alt="" coords="1508,339,1647,368"/><area shape="rect" id="node53" href="merge_8c.html#a65b859e991bbf3718673fa75b0251c85" title="merge_branches" alt="" coords="1519,392,1636,421"/><area shape="rect" id="node55" href="daemon_2repo-mgr_8h.html#a25b9a6f8f5199db34dcb95789a80eba4" title="seaf_repo_merge" alt="" coords="1796,392,1919,421"/><area shape="rect" id="node75" href="server_2repo-mgr_8h.html#ad00a42c20e1baadf267215e7e683f9e4" title="seaf_repo_manager_calc_files_last_modified" alt="" coords="808,669,1091,699"/><area shape="rect" id="node77" href="virtual-repo_8c.html#a1cd4a8c70076d40d2a778dda774a2263" title="seaf_repo_manager_cleanup_virtual_repos" alt="" coords="815,749,1084,779"/><area shape="rect" id="node61" href="fs-mgr_8h.html#a71dad49c71bdfe9223f66ad4379004d0" title="seaf_fs_manager_get_seafile_id_by_path" alt="" coords="1140,643,1401,672"/><area shape="rect" id="node63" href="fs-mgr_8h.html#a3fbd81f579b4a8594861cbc0595595ca" title="seaf_fs_manager_get_seafdir_id_by_path" alt="" coords="1140,696,1401,725"/><area shape="rect" id="node67" href="server_2repo-mgr_8h.html#a46c094895964e060809372262c9b9923" title="seaf_repo_manager_put_file" alt="" coords="1179,536,1363,565"/><area shape="rect" id="node69" href="server_2repo-mgr_8h.html#aad15cfaf3210b47e9f59a481073aafbc" title="seaf_repo_manager_put_file_blocks" alt="" coords="1156,589,1385,619"/><area shape="rect" id="node65" href="virtual-repo_8c.html#a9a8dcda29ee6cd28d92c1897ad12f268" title="seaf_repo_manager_create_virtual_repo" alt="" coords="1451,696,1704,725"/><area shape="rect" id="node73" href="fs-mgr_8h.html#a4fd132514ca9fb157d1b16a8e21bf749" title="seaf_fs_manager_traverse_path" alt="" coords="1167,907,1375,936"/><area shape="rect" id="node79" href="server_2repo-mgr_8h.html#ad6564c23b0e50d8a34dd425432b80db4" title="seaf_repo_manager_del_file" alt="" coords="1179,749,1363,779"/><area shape="rect" id="node81" href="server_2repo-mgr_8h.html#a056b45d63edfafbc5287012a2a1062ec" title="seaf_repo_manager_move_file" alt="" coords="1479,775,1676,804"/><area shape="rect" id="node84" href="server_2repo-mgr_8h.html#ae68e4b6427bb239b697e515c8617cbfb" title="seaf_repo_manager_rename_file" alt="" coords="1165,853,1376,883"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a09823d4a0c3913096cf776fa88fe638f"></a><!-- doxytag: member="obj&#45;store.c::seaf_obj_store_register_async_read" ref="a09823d4a0c3913096cf776fa88fe638f" args="(struct SeafObjStore *obj_store, const char *repo_id, int version, OSAsyncCallback callback, void *cb_data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">guint32 <a class="el" href="obj-store_8h.html#a09823d4a0c3913096cf776fa88fe638f">seaf_obj_store_register_async_read</a> </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *&#160;</td>
          <td class="paramname"><em>obj_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>repo_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="obj-store_8h.html#aa94298cc70e0f6ad59d4bc31e29441ca">OSAsyncCallback</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cb_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00376">376</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    guint32 <span class="keywordtype">id</span> = obj_store-&gt;<a class="code" href="structSeafObjStore.html#a914d0891a8b5138facec0a6869cf62db">next_rd_id</a>++;
    <a class="code" href="structOSCallbackStruct.html">OSCallbackStruct</a> *cb_struct = g_new0 (<a class="code" href="structOSCallbackStruct.html">OSCallbackStruct</a>, 1);

    memcpy (cb_struct-&gt;<a class="code" href="structOSCallbackStruct.html#ac6ea48a24fc31454377e627dc1ccab14">repo_id</a>, repo_id, 36);
    cb_struct-&gt;<a class="code" href="structOSCallbackStruct.html#a1d643ea6f2267e9c0c85699acec78312">version</a> = <a class="code" href="block-tx-utils_8h.html#a1abe2c64ac9f8bc05bbb1719cad360f3">version</a>;
    cb_struct-&gt;<a class="code" href="structOSCallbackStruct.html#aa9bacba9962258656d9efadff0d61f62">cb</a> = callback;
    cb_struct-&gt;<a class="code" href="structOSCallbackStruct.html#abb0f3259b5e4ee74929a2fdcdea11b58">cb_data</a> = cb_data;

    g_hash_table_insert (obj_store-&gt;<a class="code" href="structSeafObjStore.html#a62927e75beae41d3358ab37bfe01f379">readers</a>, (gpointer)(<span class="keywordtype">long</span>)<span class="keywordtype">id</span>, cb_struct);

    <span class="keywordflow">return</span> id;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aefe8e7c44c240a98928c610191d051b8"></a><!-- doxytag: member="obj&#45;store.c::seaf_obj_store_register_async_stat" ref="aefe8e7c44c240a98928c610191d051b8" args="(struct SeafObjStore *obj_store, const char *repo_id, int version, OSAsyncCallback callback, void *cb_data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">guint32 <a class="el" href="obj-store_8h.html#aefe8e7c44c240a98928c610191d051b8">seaf_obj_store_register_async_stat</a> </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *&#160;</td>
          <td class="paramname"><em>obj_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>repo_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="obj-store_8h.html#aa94298cc70e0f6ad59d4bc31e29441ca">OSAsyncCallback</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cb_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00423">423</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    guint32 <span class="keywordtype">id</span> = obj_store-&gt;<a class="code" href="structSeafObjStore.html#a29601589b0ffeebaa804df8622484fca">next_st_id</a>++;
    <a class="code" href="structOSCallbackStruct.html">OSCallbackStruct</a> *cb_struct = g_new0 (<a class="code" href="structOSCallbackStruct.html">OSCallbackStruct</a>, 1);

    memcpy (cb_struct-&gt;<a class="code" href="structOSCallbackStruct.html#ac6ea48a24fc31454377e627dc1ccab14">repo_id</a>, repo_id, 36);
    cb_struct-&gt;<a class="code" href="structOSCallbackStruct.html#a1d643ea6f2267e9c0c85699acec78312">version</a> = <a class="code" href="block-tx-utils_8h.html#a1abe2c64ac9f8bc05bbb1719cad360f3">version</a>;
    cb_struct-&gt;<a class="code" href="structOSCallbackStruct.html#aa9bacba9962258656d9efadff0d61f62">cb</a> = callback;
    cb_struct-&gt;<a class="code" href="structOSCallbackStruct.html#abb0f3259b5e4ee74929a2fdcdea11b58">cb_data</a> = cb_data;

    g_hash_table_insert (obj_store-&gt;<a class="code" href="structSeafObjStore.html#a29869c4f173bffdbb2f2ec11f94b5b1d">stats</a>, (gpointer)(<span class="keywordtype">long</span>)<span class="keywordtype">id</span>, cb_struct);

    <span class="keywordflow">return</span> id;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a20498bde091546677a081d7590fefacb"></a><!-- doxytag: member="obj&#45;store.c::seaf_obj_store_register_async_write" ref="a20498bde091546677a081d7590fefacb" args="(struct SeafObjStore *obj_store, const char *repo_id, int version, OSAsyncCallback callback, void *cb_data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">guint32 <a class="el" href="obj-store_8h.html#a20498bde091546677a081d7590fefacb">seaf_obj_store_register_async_write</a> </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *&#160;</td>
          <td class="paramname"><em>obj_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>repo_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="obj-store_8h.html#aa94298cc70e0f6ad59d4bc31e29441ca">OSAsyncCallback</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>cb_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00470">470</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    guint32 <span class="keywordtype">id</span> = obj_store-&gt;<a class="code" href="structSeafObjStore.html#a914d0891a8b5138facec0a6869cf62db">next_rd_id</a>++;
    <a class="code" href="structOSCallbackStruct.html">OSCallbackStruct</a> *cb_struct = g_new0 (<a class="code" href="structOSCallbackStruct.html">OSCallbackStruct</a>, 1);

    memcpy (cb_struct-&gt;<a class="code" href="structOSCallbackStruct.html#ac6ea48a24fc31454377e627dc1ccab14">repo_id</a>, repo_id, 36);
    cb_struct-&gt;<a class="code" href="structOSCallbackStruct.html#a1d643ea6f2267e9c0c85699acec78312">version</a> = <a class="code" href="block-tx-utils_8h.html#a1abe2c64ac9f8bc05bbb1719cad360f3">version</a>;
    cb_struct-&gt;<a class="code" href="structOSCallbackStruct.html#aa9bacba9962258656d9efadff0d61f62">cb</a> = callback;
    cb_struct-&gt;<a class="code" href="structOSCallbackStruct.html#abb0f3259b5e4ee74929a2fdcdea11b58">cb_data</a> = cb_data;

    g_hash_table_insert (obj_store-&gt;<a class="code" href="structSeafObjStore.html#a2c295d6ed2d59079c5cac105ed35e423">writers</a>, (gpointer)(<span class="keywordtype">long</span>)<span class="keywordtype">id</span>, cb_struct);

    <span class="keywordflow">return</span> id;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a247f0d971299f7e837abcdb2de27b18c"></a><!-- doxytag: member="obj&#45;store.c::seaf_obj_store_unregister_async_read" ref="a247f0d971299f7e837abcdb2de27b18c" args="(struct SeafObjStore *obj_store, guint32 reader_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="obj-store_8h.html#a247f0d971299f7e837abcdb2de27b18c">seaf_obj_store_unregister_async_read</a> </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *&#160;</td>
          <td class="paramname"><em>obj_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">guint32&#160;</td>
          <td class="paramname"><em>reader_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00396">396</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    g_hash_table_remove (obj_store-&gt;<a class="code" href="structSeafObjStore.html#a62927e75beae41d3358ab37bfe01f379">readers</a>, (gpointer)(<span class="keywordtype">long</span>)reader_id);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4633a0fe044d9831be5abfeb5c09a38f"></a><!-- doxytag: member="obj&#45;store.c::seaf_obj_store_unregister_async_stat" ref="a4633a0fe044d9831be5abfeb5c09a38f" args="(struct SeafObjStore *obj_store, guint32 stat_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="obj-store_8h.html#a4633a0fe044d9831be5abfeb5c09a38f">seaf_obj_store_unregister_async_stat</a> </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *&#160;</td>
          <td class="paramname"><em>obj_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">guint32&#160;</td>
          <td class="paramname"><em>stat_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00443">443</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    g_hash_table_remove (obj_store-&gt;<a class="code" href="structSeafObjStore.html#a29869c4f173bffdbb2f2ec11f94b5b1d">stats</a>, (gpointer)(<span class="keywordtype">long</span>)stat_id);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2b7b66e759297fae9d029eb86c2595ac"></a><!-- doxytag: member="obj&#45;store.c::seaf_obj_store_unregister_async_write" ref="a2b7b66e759297fae9d029eb86c2595ac" args="(struct SeafObjStore *obj_store, guint32 writer_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="obj-store_8h.html#a2b7b66e759297fae9d029eb86c2595ac">seaf_obj_store_unregister_async_write</a> </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *&#160;</td>
          <td class="paramname"><em>obj_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">guint32&#160;</td>
          <td class="paramname"><em>writer_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00490">490</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    g_hash_table_remove (obj_store-&gt;<a class="code" href="structSeafObjStore.html#a2c295d6ed2d59079c5cac105ed35e423">writers</a>, (gpointer)(<span class="keywordtype">long</span>)writer_id);
}
</pre></div>
</div>
</div>
<a class="anchor" id="a673d1262bbb4caf66816c89bde13b429"></a><!-- doxytag: member="obj&#45;store.c::seaf_obj_store_write_obj" ref="a673d1262bbb4caf66816c89bde13b429" args="(struct SeafObjStore *obj_store, const char *repo_id, int version, const char *obj_id, void *data, int len, gboolean need_sync)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="obj-store_8h.html#a673d1262bbb4caf66816c89bde13b429">seaf_obj_store_write_obj</a> </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structSeafObjStore.html">SeafObjStore</a> *&#160;</td>
          <td class="paramname"><em>obj_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>repo_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>obj_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&#160;</td>
          <td class="paramname"><em>need_sync</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="obj-store_8c_source.html#l00175">175</a> of file <a class="el" href="obj-store_8c_source.html">obj-store.c</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="structObjBackend.html">ObjBackend</a> *bend = obj_store-&gt;<a class="code" href="structSeafObjStore.html#aa6d49025e2d6adcd47d3b423bb63c06b">bend</a>;

    <span class="keywordflow">return</span> bend-&gt;<a class="code" href="structObjBackend.html#aa3722d257b0a127dd5ff23e07ce5c2f6">write</a> (bend, repo_id, <a class="code" href="block-tx-utils_8h.html#a1abe2c64ac9f8bc05bbb1719cad360f3">version</a>, <a class="code" href="Backups_2http-server_8c.html#acdc8b2e33d61c23557d7e7563f00ef6f">obj_id</a>, data, len, need_sync);
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="obj-store_8c_a673d1262bbb4caf66816c89bde13b429_icgraph.png" border="0" usemap="#obj-store_8c_a673d1262bbb4caf66816c89bde13b429_icgraph" alt=""/></div>
<map name="obj-store_8c_a673d1262bbb4caf66816c89bde13b429_icgraph" id="obj-store_8c_a673d1262bbb4caf66816c89bde13b429_icgraph">
<area shape="rect" id="node3" href="fs-mgr_8h.html#a6d5e7c9f24bc74592e3f83f624e79c8b" title="seafile_save" alt="" coords="227,5,320,35"/><area shape="rect" id="node5" href="fs-mgr_8h.html#a6335345f24b4ae73c65cf12e2b2d57b3" title="seaf_dir_save" alt="" coords="223,59,324,88"/><area shape="rect" id="node7" href="vc-utils_8h.html#a40a8e3a1dc14697c58656246b3fa9ca0" title="commit_trees_cb" alt="" coords="373,59,496,88"/><area shape="rect" id="node9" href="daemon_2repo-mgr_8h.html#a77e557bb1fedd648a109ab5d9bff5ef4" title="seaf_repo_index_worktree_files" alt="" coords="544,5,749,35"/><area shape="rect" id="node11" href="daemon_2repo-mgr_8h.html#ab6d5318b3a1cc6f86733ff71b16815a8" title="seaf_repo_index_commit" alt="" coords="564,59,729,88"/><area shape="rect" id="node13" href="merge-recursive_8h.html#a5ece2c4c0b1acc045660424d1fb74f36" title="write_tree_from_memory" alt="" coords="564,112,729,141"/><area shape="rect" id="node15" href="merge-recursive_8h.html#ac5c545b083f8e950f4e13cb31b4a74d1" title="merge_recursive" alt="" coords="799,112,916,141"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Wed Aug 19 2015 03:59:44 for My Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
